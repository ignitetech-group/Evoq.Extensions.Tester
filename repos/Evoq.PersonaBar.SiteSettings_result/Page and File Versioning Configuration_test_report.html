<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Report: Page and File Versioning Configuration</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 15px;
        }
        h2 {
            color: #34495e;
            margin-top: 30px;
            border-left: 4px solid #3498db;
            padding-left: 15px;
        }
        h3 {
            color: #7f8c8d;
        }
        .feature-info {
            background: #ecf0f1;
            padding: 20px;
            border-radius: 5px;
            margin: 20px 0;
        }
        .feature-info dt {
            font-weight: bold;
            color: #2c3e50;
        }
        .feature-info dd {
            margin-left: 0;
            margin-bottom: 10px;
            padding-left: 20px;
        }
        .test-scenario {
            border: 1px solid #ddd;
            margin: 20px 0;
            border-radius: 5px;
            overflow: hidden;
        }
        .scenario-header {
            background: #3498db;
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .scenario-header h3 {
            margin: 0;
            color: white;
        }
        .status {
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 14px;
        }
        .status.pass {
            background: #27ae60;
            color: white;
        }
        .status.fail {
            background: #e74c3c;
            color: white;
        }
        .scenario-body {
            padding: 20px;
        }
        .steps {
            background: #f9f9f9;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
        }
        .steps ol {
            margin: 0;
            padding-left: 25px;
        }
        .steps li {
            margin: 8px 0;
        }
        .screenshot {
            margin: 20px 0;
            text-align: center;
        }
        .screenshot img {
            max-width: 100%;
            border: 1px solid #ddd;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .screenshot-caption {
            color: #7f8c8d;
            font-style: italic;
            margin-top: 10px;
        }
        .observations {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 15px 0;
        }
        .summary {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            padding: 20px;
            border-radius: 5px;
            margin-top: 30px;
        }
        .summary h2 {
            color: #155724;
            border-left-color: #28a745;
            margin-top: 0;
        }
        .summary-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        .summary-table th, .summary-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        .summary-table th {
            background: #f8f9fa;
            font-weight: bold;
        }
        .code-info {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 5px;
            font-family: 'Consolas', monospace;
            font-size: 13px;
            overflow-x: auto;
        }
        .validation-info {
            background: #e8f4fd;
            border-left: 4px solid #3498db;
            padding: 15px;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Test Report: Page and File Versioning Configuration</h1>

        <div class="feature-info">
            <dl>
                <dt>Extension:</dt>
                <dd>Evoq.PersonaBar.SiteSettings (PersonaBar Module)</dd>

                <dt>Feature Name:</dt>
                <dd>Page and File Versioning Configuration</dd>

                <dt>Description:</dt>
                <dd>Manages version control settings for both pages and files, allowing administrators to enable/disable versioning and set maximum version limits</dd>

                <dt>UI Location:</dt>
                <dd>Admin &gt; Settings &gt; Site Settings &gt; Site Behavior &gt; More &gt; Versioning</dd>

                <dt>Test Date:</dt>
                <dd>December 30, 2025</dd>

                <dt>Test Environment:</dt>
                <dd>http://localhost:8081 (Superuser: host)</dd>
            </dl>
        </div>

        <h2>Code Analysis</h2>
        <div class="validation-info">
            <h4>Validation Rules (from Versioning/index.jsx)</h4>
            <ul>
                <li><strong>Page Versions:</strong> Valid range 1-20</li>
                <li><strong>File Versions:</strong> Valid range 5-25</li>
            </ul>
            <div class="code-info">
                function validateRange(min, max, value) {<br>
                &nbsp;&nbsp;return value >= min && value <= max;<br>
                }<br><br>
                // Page versions: validateRange(1, 20, value)<br>
                // File versions: validateRange(5, 25, value)
            </div>
        </div>

        <!-- Test Scenario 1: Initial State -->
        <div class="test-scenario">
            <div class="scenario-header">
                <h3>Scenario 1: View Initial Versioning Settings</h3>
                <span class="status pass">PASS</span>
            </div>
            <div class="scenario-body">
                <p><strong>Objective:</strong> Navigate to versioning settings and verify UI displays correctly</p>
                <div class="steps">
                    <ol>
                        <li>Login as host superuser</li>
                        <li>Navigate to Settings &gt; Site Settings</li>
                        <li>Click Site Behavior tab</li>
                        <li>Click More sub-tab</li>
                        <li>Verify Versioning section is visible with Page and File versioning controls</li>
                    </ol>
                </div>
                <div class="screenshot">
                    <img src="Page_and_File_Versioning_Configuration_step01_initial_state.png" alt="Initial State">
                    <p class="screenshot-caption">Initial versioning settings showing Page and File versioning toggles and max version fields</p>
                </div>
                <p><strong>Result:</strong> Versioning section displayed correctly with both Page and File versioning controls.</p>
            </div>
        </div>

        <!-- Test Scenario 2: Page Versioning Enable/Disable -->
        <div class="test-scenario">
            <div class="scenario-header">
                <h3>Scenario 2: Enable/Disable Page Versioning</h3>
                <span class="status pass">PASS</span>
            </div>
            <div class="scenario-body">
                <p><strong>Objective:</strong> Test toggling page versioning on and off</p>
                <div class="steps">
                    <ol>
                        <li>Click the Page Versioning toggle to disable (Off)</li>
                        <li>Click Save button</li>
                        <li>Verify setting is saved</li>
                        <li>Click the Page Versioning toggle to enable (On)</li>
                        <li>Click Save button</li>
                        <li>Verify setting is saved</li>
                    </ol>
                </div>
                <div class="screenshot">
                    <img src="Page_and_File_Versioning_Configuration_step02_page_versioning_disabled.png" alt="Page Versioning Disabled">
                    <p class="screenshot-caption">Page versioning toggle set to Off</p>
                </div>
                <div class="screenshot">
                    <img src="Page_and_File_Versioning_Configuration_step03_page_versioning_saved.png" alt="Page Versioning Saved">
                    <p class="screenshot-caption">Settings saved successfully (Cancel/Save buttons disabled indicating saved state)</p>
                </div>
                <div class="screenshot">
                    <img src="Page_and_File_Versioning_Configuration_step04_page_versioning_enabled.png" alt="Page Versioning Enabled">
                    <p class="screenshot-caption">Page versioning toggle set back to On</p>
                </div>
                <p><strong>Result:</strong> Page versioning can be successfully toggled on and off. Settings save correctly.</p>
            </div>
        </div>

        <!-- Test Scenario 3: Page Versioning Valid Range -->
        <div class="test-scenario">
            <div class="scenario-header">
                <h3>Scenario 3: Set Maximum Page Versions (Valid Range 1-20)</h3>
                <span class="status pass">PASS</span>
            </div>
            <div class="scenario-body">
                <p><strong>Objective:</strong> Set max page versions to a valid value within range (1-20)</p>
                <div class="steps">
                    <ol>
                        <li>Clear the Max Page Versions field</li>
                        <li>Enter value "15" (within valid range 1-20)</li>
                        <li>Click Save button</li>
                        <li>Verify setting is saved without validation errors</li>
                    </ol>
                </div>
                <div class="screenshot">
                    <img src="Page_and_File_Versioning_Configuration_step05_page_versions_15.png" alt="Page Versions Set to 15">
                    <p class="screenshot-caption">Max page versions set to 15 - no validation error displayed</p>
                </div>
                <p><strong>Result:</strong> Value 15 accepted and saved successfully. No validation errors shown.</p>
            </div>
        </div>

        <!-- Test Scenario 4: Page Versioning Invalid Range -->
        <div class="test-scenario">
            <div class="scenario-header">
                <h3>Scenario 4: Page Versions Validation (Outside Valid Range)</h3>
                <span class="status pass">PASS</span>
            </div>
            <div class="scenario-body">
                <p><strong>Objective:</strong> Attempt to set max page versions outside valid range and verify validation error</p>
                <div class="steps">
                    <ol>
                        <li>Clear the Max Page Versions field</li>
                        <li>Enter value "25" (outside valid range 1-20)</li>
                        <li>Click Save button</li>
                        <li>Verify validation error is displayed (red indicator)</li>
                    </ol>
                </div>
                <div class="screenshot">
                    <img src="Page_and_File_Versioning_Configuration_step06_page_versions_invalid_25.png" alt="Page Versions Invalid">
                    <p class="screenshot-caption">Value 25 shows validation error - red exclamation mark indicator visible next to the field</p>
                </div>
                <div class="observations">
                    <strong>Observation:</strong> Client-side validation correctly prevents saving invalid values. The red exclamation mark icon indicates the validation error. The form cannot be saved until the value is corrected.
                </div>
                <p><strong>Result:</strong> Validation error correctly displayed for value outside range (25 > 20).</p>
            </div>
        </div>

        <!-- Test Scenario 5: File Versioning Enable/Disable -->
        <div class="test-scenario">
            <div class="scenario-header">
                <h3>Scenario 5: Enable/Disable File Versioning</h3>
                <span class="status pass">PASS</span>
            </div>
            <div class="scenario-body">
                <p><strong>Objective:</strong> Test toggling file versioning on and off</p>
                <div class="steps">
                    <ol>
                        <li>Reset page versions to valid value (10)</li>
                        <li>Click the File Versioning toggle to disable (Off)</li>
                        <li>Click Save button</li>
                        <li>Verify setting is saved</li>
                    </ol>
                </div>
                <div class="screenshot">
                    <img src="Page_and_File_Versioning_Configuration_step07_file_versioning_disabled.png" alt="File Versioning Disabled">
                    <p class="screenshot-caption">File versioning toggle set to Off</p>
                </div>
                <p><strong>Result:</strong> File versioning can be successfully toggled off. Settings save correctly.</p>
            </div>
        </div>

        <!-- Test Scenario 6: File Versioning Valid Range -->
        <div class="test-scenario">
            <div class="scenario-header">
                <h3>Scenario 6: Set Maximum File Versions (Valid Range 5-25)</h3>
                <span class="status pass">PASS</span>
            </div>
            <div class="scenario-body">
                <p><strong>Objective:</strong> Set max file versions to a valid value within range (5-25)</p>
                <div class="steps">
                    <ol>
                        <li>Re-enable File Versioning toggle (On)</li>
                        <li>Clear the Max File Versions field</li>
                        <li>Enter value "20" (within valid range 5-25)</li>
                        <li>Click Save button</li>
                        <li>Verify setting is saved without validation errors</li>
                    </ol>
                </div>
                <div class="screenshot">
                    <img src="Page_and_File_Versioning_Configuration_step08_file_versions_20.png" alt="File Versions Set to 20">
                    <p class="screenshot-caption">Max file versions set to 20 - no validation error displayed</p>
                </div>
                <p><strong>Result:</strong> Value 20 accepted and saved successfully. No validation errors shown.</p>
            </div>
        </div>

        <!-- Test Scenario 7: File Versioning Invalid Range -->
        <div class="test-scenario">
            <div class="scenario-header">
                <h3>Scenario 7: File Versions Validation (Outside Valid Range)</h3>
                <span class="status pass">PASS</span>
            </div>
            <div class="scenario-body">
                <p><strong>Objective:</strong> Attempt to set max file versions outside valid range and verify validation error</p>
                <div class="steps">
                    <ol>
                        <li>Clear the Max File Versions field</li>
                        <li>Enter value "3" (below valid range 5-25)</li>
                        <li>Click Save button</li>
                        <li>Verify validation error is displayed (red indicator)</li>
                    </ol>
                </div>
                <div class="screenshot">
                    <img src="Page_and_File_Versioning_Configuration_step09_file_versions_invalid_3.png" alt="File Versions Invalid">
                    <p class="screenshot-caption">Value 3 shows validation error - red exclamation mark indicator visible next to the field</p>
                </div>
                <div class="observations">
                    <strong>Observation:</strong> Client-side validation correctly prevents saving values below minimum. The red exclamation mark icon indicates the validation error for value 3 which is below the minimum of 5.
                </div>
                <p><strong>Result:</strong> Validation error correctly displayed for value outside range (3 < 5).</p>
            </div>
        </div>

        <!-- Test Scenario 8: Persistence After Refresh -->
        <div class="test-scenario">
            <div class="scenario-header">
                <h3>Scenario 8: Verify Settings Persist After Page Refresh</h3>
                <span class="status pass">PASS</span>
            </div>
            <div class="scenario-body">
                <p><strong>Objective:</strong> Verify that saved settings persist after refreshing the page</p>
                <div class="steps">
                    <ol>
                        <li>Reset values to valid settings (Page: On/10, File: On/5)</li>
                        <li>Click Save button</li>
                        <li>Refresh the browser page</li>
                        <li>Navigate back to Versioning settings</li>
                        <li>Verify all saved values are retained</li>
                    </ol>
                </div>
                <div class="screenshot">
                    <img src="Page_and_File_Versioning_Configuration_step10_persistence_verified.png" alt="Persistence Verified">
                    <p class="screenshot-caption">After page refresh: Page Versioning On/10, File Versioning On/5 - all values persisted correctly</p>
                </div>
                <p><strong>Result:</strong> All settings (Page Versioning: On with max 10, File Versioning: On with max 5) persisted correctly after page refresh.</p>
            </div>
        </div>

        <!-- Summary -->
        <div class="summary">
            <h2>Test Summary</h2>
            <table class="summary-table">
                <thead>
                    <tr>
                        <th>Test Scenario</th>
                        <th>Description</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>1</td>
                        <td>View Initial Versioning Settings</td>
                        <td><span class="status pass">PASS</span></td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>Enable/Disable Page Versioning</td>
                        <td><span class="status pass">PASS</span></td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td>Set Maximum Page Versions (Valid Range 1-20)</td>
                        <td><span class="status pass">PASS</span></td>
                    </tr>
                    <tr>
                        <td>4</td>
                        <td>Page Versions Validation (Outside Valid Range)</td>
                        <td><span class="status pass">PASS</span></td>
                    </tr>
                    <tr>
                        <td>5</td>
                        <td>Enable/Disable File Versioning</td>
                        <td><span class="status pass">PASS</span></td>
                    </tr>
                    <tr>
                        <td>6</td>
                        <td>Set Maximum File Versions (Valid Range 5-25)</td>
                        <td><span class="status pass">PASS</span></td>
                    </tr>
                    <tr>
                        <td>7</td>
                        <td>File Versions Validation (Outside Valid Range)</td>
                        <td><span class="status pass">PASS</span></td>
                    </tr>
                    <tr>
                        <td>8</td>
                        <td>Verify Settings Persist After Page Refresh</td>
                        <td><span class="status pass">PASS</span></td>
                    </tr>
                </tbody>
            </table>

            <h3>Overall Result: <span style="color: #27ae60;">ALL TESTS PASSED (8/8)</span></h3>

            <h3>Key Findings:</h3>
            <ul>
                <li>Page versioning toggle works correctly (enable/disable)</li>
                <li>File versioning toggle works correctly (enable/disable)</li>
                <li>Client-side validation enforces valid ranges:
                    <ul>
                        <li>Page versions: 1-20</li>
                        <li>File versions: 5-25</li>
                    </ul>
                </li>
                <li>Invalid values display a red exclamation mark error indicator</li>
                <li>Settings persist correctly after page refresh</li>
                <li>Save button becomes disabled after successful save (indicating clean state)</li>
            </ul>

            <h3>Notes:</h3>
            <ul>
                <li>Validation is triggered on save attempt (triedToSave state in Redux)</li>
                <li>The versioning feature requires Host/Superuser permissions ([RequireHost] attribute on API)</li>
                <li>Multi-portal support is available via optional portalId parameter in API endpoints</li>
            </ul>
        </div>
    </div>
</body>
</html>
