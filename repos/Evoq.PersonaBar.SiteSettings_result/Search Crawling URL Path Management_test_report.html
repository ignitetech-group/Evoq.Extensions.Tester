<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Report: Search Crawling URL Path Management</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 30px;
        }
        .header h1 {
            margin: 0 0 10px 0;
            font-size: 2em;
        }
        .header p {
            margin: 5px 0;
            opacity: 0.9;
        }
        .summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .summary-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            text-align: center;
        }
        .summary-card.pass { border-left: 5px solid #28a745; }
        .summary-card.fail { border-left: 5px solid #dc3545; }
        .summary-card.bug { border-left: 5px solid #ffc107; }
        .summary-card.total { border-left: 5px solid #667eea; }
        .summary-card h3 { margin: 0; font-size: 2.5em; }
        .summary-card p { margin: 5px 0 0 0; color: #666; }
        .test-scenario {
            background: white;
            margin-bottom: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .test-header {
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #eee;
        }
        .test-header h2 {
            margin: 0;
            font-size: 1.3em;
        }
        .status {
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: bold;
            text-transform: uppercase;
            font-size: 0.85em;
        }
        .status.pass { background: #d4edda; color: #155724; }
        .status.fail { background: #f8d7da; color: #721c24; }
        .status.bug { background: #fff3cd; color: #856404; }
        .test-content {
            padding: 20px;
        }
        .test-steps {
            margin-bottom: 20px;
        }
        .test-steps h4 {
            margin: 0 0 10px 0;
            color: #333;
        }
        .test-steps ol {
            margin: 0;
            padding-left: 20px;
        }
        .test-steps li {
            margin-bottom: 8px;
        }
        .screenshots {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 15px;
        }
        .screenshot {
            border: 1px solid #ddd;
            border-radius: 8px;
            overflow: hidden;
        }
        .screenshot img {
            width: 100%;
            display: block;
        }
        .screenshot-caption {
            padding: 10px;
            background: #f8f9fa;
            font-size: 0.9em;
            color: #666;
            text-align: center;
        }
        .observations {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
        }
        .observations h4 {
            margin: 0 0 10px 0;
            color: #333;
        }
        .bug-report {
            background: #fff3cd;
            border: 1px solid #ffc107;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
        }
        .bug-report h3 {
            color: #856404;
            margin: 0 0 15px 0;
        }
        .bug-report ul {
            margin: 0;
            padding-left: 20px;
        }
        .code-block {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.9em;
        }
        .footer {
            text-align: center;
            padding: 20px;
            color: #666;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Test Report: Search Crawling URL Path Management</h1>
        <p><strong>Extension:</strong> Evoq.PersonaBar.SiteSettings (PersonaBar Module)</p>
        <p><strong>Feature Priority:</strong> Top</p>
        <p><strong>UI Location:</strong> Admin > Settings > Site Settings > Search > Crawling > URL Paths</p>
        <p><strong>Test Date:</strong> December 30, 2025</p>
    </div>

    <div class="summary">
        <div class="summary-card total">
            <h3>3</h3>
            <p>Total Tests</p>
        </div>
        <div class="summary-card pass">
            <h3>2</h3>
            <p>Passed</p>
        </div>
        <div class="summary-card bug">
            <h3>1</h3>
            <p>Bug Found</p>
        </div>
        <div class="summary-card fail">
            <h3>0</h3>
            <p>Failed</p>
        </div>
    </div>

    <div class="bug-report">
        <h3>Bug Report: Invalid URL Validation Not Working</h3>
        <ul>
            <li><strong>Severity:</strong> Medium</li>
            <li><strong>Component:</strong> URL Path Management - URL validation</li>
            <li><strong>Description:</strong> Invalid URLs (e.g., "not-a-valid-url") can be saved without triggering validation errors. The client-side validation exists in the code but does not prevent the save action.</li>
            <li><strong>Steps to Reproduce:</strong>
                <ol>
                    <li>Navigate to Admin > Settings > Site Settings > Search > Crawling > URL Paths</li>
                    <li>Click "Add URL Path"</li>
                    <li>Enter an invalid URL format (e.g., "not-a-valid-url")</li>
                    <li>Click "Save"</li>
                </ol>
            </li>
            <li><strong>Expected Result:</strong> Validation error should appear and prevent saving</li>
            <li><strong>Actual Result:</strong> Invalid URL is saved to the system</li>
            <li><strong>Root Cause Analysis:</strong> The <code>validateUrl()</code> function in the React component only sets an error styling via <code>error={!validateUrl(urlPath.url) && triedToSave}</code> but does not block the save action. The server-side validation in <code>EvoqSiteSettingsController.cs</code> only checks for empty strings: <code>Requires.NotNullOrEmpty("Url", crawlerUrlDetailDto.Url)</code></li>
        </ul>
    </div>

    <div class="test-scenario">
        <div class="test-header">
            <h2>Test 1: Add New URL Path with Valid URL</h2>
            <span class="status pass">PASS</span>
        </div>
        <div class="test-content">
            <div class="test-steps">
                <h4>Test Steps</h4>
                <ol>
                    <li>Login to the site as host (superuser)</li>
                    <li>Navigate to Admin > Settings > Site Settings</li>
                    <li>Click on "Search" tab, then "Crawling" sub-tab</li>
                    <li>Locate the "URL Paths" section</li>
                    <li>Click "Add URL Path" button</li>
                    <li>Enter valid URL: "http://example.com/test-crawl-path"</li>
                    <li>Click "Save" button</li>
                    <li>Verify the URL appears in the list</li>
                </ol>
            </div>
            <div class="screenshots">
                <div class="screenshot">
                    <img src="Search Crawling URL Path Management_step01_login_page.png" alt="Login Page">
                    <div class="screenshot-caption">Step 1: Login Page</div>
                </div>
                <div class="screenshot">
                    <img src="Search Crawling URL Path Management_step02_crawling_url_paths.png" alt="URL Paths Section">
                    <div class="screenshot-caption">Step 2: URL Paths Section in Crawling Settings</div>
                </div>
                <div class="screenshot">
                    <img src="Search Crawling URL Path Management_step03_add_url_form.png" alt="Add URL Form">
                    <div class="screenshot-caption">Step 3: Add URL Form with Valid URL Entered</div>
                </div>
                <div class="screenshot">
                    <img src="Search Crawling URL Path Management_step04_url_added_success.png" alt="URL Added Successfully">
                    <div class="screenshot-caption">Step 4: URL Successfully Added to List</div>
                </div>
            </div>
            <div class="observations">
                <h4>Observations</h4>
                <p>The URL path was successfully added to the system. The form displays all expected fields including URL, Sitemap URL, DNN Role Impersonation, Enable Spidering toggle, and Windows Authentication settings (Domain, Username, Password). The save operation completed without errors.</p>
            </div>
        </div>
    </div>

    <div class="test-scenario">
        <div class="test-header">
            <h2>Test 2: Add URL Path with Invalid URL Format</h2>
            <span class="status bug">BUG FOUND</span>
        </div>
        <div class="test-content">
            <div class="test-steps">
                <h4>Test Steps</h4>
                <ol>
                    <li>Click "Add URL Path" button to add a new entry</li>
                    <li>Enter an invalid URL format: "not-a-valid-url"</li>
                    <li>Click "Save" button</li>
                    <li>Observe that no validation error is shown</li>
                    <li>Verify the invalid URL was saved to the system</li>
                </ol>
            </div>
            <div class="screenshots">
                <div class="screenshot">
                    <img src="Search Crawling URL Path Management_step05_invalid_url_entered.png" alt="Invalid URL Entered">
                    <div class="screenshot-caption">Step 1: Invalid URL "not-a-valid-url" Entered</div>
                </div>
                <div class="screenshot">
                    <img src="Search Crawling URL Path Management_step06_invalid_url_saved_bug.png" alt="Invalid URL Saved - Bug">
                    <div class="screenshot-caption">Step 2: Invalid URL Was Saved Without Validation Error (BUG)</div>
                </div>
            </div>
            <div class="observations">
                <h4>Observations</h4>
                <p><strong>BUG:</strong> The system accepted and saved an invalid URL format without displaying any validation error. The expected behavior is that the system should validate the URL format before saving and display an error message if the URL is invalid. The client-side code has a <code>validateUrl()</code> function that appears to set error styling, but it does not prevent the form submission. Server-side validation only checks if the URL field is empty.</p>
            </div>
        </div>
    </div>

    <div class="test-scenario">
        <div class="test-header">
            <h2>Test 3: Delete URL Path</h2>
            <span class="status pass">PASS</span>
        </div>
        <div class="test-content">
            <div class="test-steps">
                <h4>Test Steps</h4>
                <ol>
                    <li>Locate an existing URL path in the list</li>
                    <li>Click the delete (trash) icon for the URL</li>
                    <li>Observe the confirmation dialog</li>
                    <li>Click "Yes" to confirm deletion</li>
                    <li>Verify the URL is removed from the list</li>
                </ol>
            </div>
            <div class="screenshots">
                <div class="screenshot">
                    <img src="Search Crawling URL Path Management_step07_unsaved_changes_warning.png" alt="Unsaved Changes Warning">
                    <div class="screenshot-caption">Step 1: Navigating Away Warning Dialog</div>
                </div>
                <div class="screenshot">
                    <img src="Search Crawling URL Path Management_step08_delete_confirmation.png" alt="Delete Confirmation">
                    <div class="screenshot-caption">Step 2: Delete Confirmation Dialog</div>
                </div>
                <div class="screenshot">
                    <img src="Search Crawling URL Path Management_step09_url_deleted.png" alt="URL Deleted">
                    <div class="screenshot-caption">Step 3: URL Successfully Deleted from List</div>
                </div>
                <div class="screenshot">
                    <img src="Search Crawling URL Path Management_step10_final_state.png" alt="Final State">
                    <div class="screenshot-caption">Step 4: Final State - URL Paths List</div>
                </div>
            </div>
            <div class="observations">
                <h4>Observations</h4>
                <p>The delete functionality works correctly. When clicking the delete icon, a confirmation dialog appears asking "Are you sure you want to delete this item?" with "Yes" and "No" options. Upon confirming, the URL is removed from the list immediately. Additionally, the system shows an "Unsaved Changes" warning when navigating away from a form with unsaved data, which is good UX.</p>
            </div>
        </div>
    </div>

    <div class="test-scenario">
        <div class="test-header">
            <h2>Feature Details Summary</h2>
            <span class="status">INFO</span>
        </div>
        <div class="test-content">
            <div class="test-steps">
                <h4>Feature Description</h4>
                <p>The Search Crawling URL Path Management feature manages URL paths that should be crawled for search indexing. It includes the following capabilities:</p>
                <ul>
                    <li><strong>URL Path:</strong> The main URL to crawl</li>
                    <li><strong>Sitemap URL:</strong> Optional sitemap URL associated with the path</li>
                    <li><strong>DNN Role Impersonation:</strong> Crawl as a specific DNN role for permission-based content</li>
                    <li><strong>Enable Spidering:</strong> Toggle to enable/disable crawling for this URL</li>
                    <li><strong>Windows Authentication:</strong> Support for Windows-authenticated sites with domain, username, and password</li>
                </ul>
            </div>
            <div class="observations">
                <h4>Test Scenarios Not Fully Tested</h4>
                <ul>
                    <li>Configure Windows authentication for URL path (partially observed - fields available)</li>
                    <li>Configure DNN role-based authentication (fields available but not tested with actual roles)</li>
                    <li>Add sitemap URL to URL path (field available but not tested independently)</li>
                    <li>Add invalid sitemap URL and verify validation (not tested)</li>
                    <li>Verify encrypted password storage (not verifiable via UI)</li>
                    <li>Add duplicate URL path (not tested)</li>
                    <li>Edit existing URL path details (attempted but edit icon proximity to delete icon made it difficult)</li>
                </ul>
            </div>
        </div>
    </div>

    <div class="footer">
        <p>Test Report Generated by Claude Code | Evoq.PersonaBar.SiteSettings Extension Testing</p>
        <p>Repository: Dnn.AdminExperience.Evoq.Basic</p>
    </div>
</body>
</html>
