{
  "metadata": {
    "extension_name": "Evoq.Social.ActivityStream",
    "extension_type": "Module",
    "feature_name": "Post Pinning",
    "feature_description": "Pin important posts to the top of the activity stream (moderator feature)",
    "feature_priority": "Medium",
    "test_date": "2026-02-09T16:24:00Z",
    "tester": "Claude"
  },
  "test_scenarios": [
    {
      "scenario_name": "Pin a post as moderator",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Navigate to Community page with Activity Stream",
          "expected": "Activity Stream displays with posts",
          "actual": "Activity Stream displayed with multiple posts visible",
          "screenshot": "Post Pinning_step02_activity_stream_posts_visible.png"
        },
        {
          "step_number": 2,
          "action": "Locate Pin link on a post (as moderator/superuser)",
          "expected": "Pin link should be visible for moderators",
          "actual": "Pin links visible on posts for the superuser account",
          "screenshot": "Post Pinning_step02_activity_stream_posts_visible.png"
        },
        {
          "step_number": 3,
          "action": "Click Pin link on a post",
          "expected": "Post should be pinned, Pin link changes to Unpin, blue pin icon appears",
          "actual": "Post was pinned successfully, Pin link changed to Unpin, blue pin icon appeared on post, post moved to top of activity stream",
          "screenshot": "Post Pinning_step03_post_pinned_successfully.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Verify pinned post appears at top",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "After pinning a post, observe its position in activity stream",
          "expected": "Pinned post should move to top of activity stream",
          "actual": "Pinned post immediately moved to the top of the activity stream with blue pin icon visible",
          "screenshot": "Post Pinning_step03_post_pinned_successfully.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Unpin a previously pinned post",
      "status": "FAIL",
      "steps": [
        {
          "step_number": 1,
          "action": "Click Unpin link on a pinned post",
          "expected": "Post should be unpinned, Unpin link changes back to Pin, pin icon disappears",
          "actual": "API error occurred - alert dialog with 'undefined' message appeared, console showed 500 error from TogglePin endpoint",
          "screenshot": "Post Pinning_step04_unpin_error.png"
        }
      ],
      "issues": [
        "Unpin operation fails with API error - TogglePin endpoint returns 500 error with 'undefined' message when attempting to unpin a post"
      ]
    },
    {
      "scenario_name": "Pin multiple posts",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Pin first post using Pin link",
          "expected": "First post should be pinned with Unpin link visible",
          "actual": "First post pinned successfully, shows Unpin link and blue pin icon",
          "screenshot": "Post Pinning_step06_multiple_posts_pinned.png"
        },
        {
          "step_number": 2,
          "action": "Pin second post using Pin link",
          "expected": "Second post should be pinned and move to top, both posts show as pinned",
          "actual": "Second post pinned successfully, moved to top of stream, both pinned posts visible with blue pin icons and Unpin links",
          "screenshot": "Post Pinning_step06_multiple_posts_pinned.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Verify pin status across page refresh",
      "status": "FAIL",
      "steps": [
        {
          "step_number": 1,
          "action": "After pinning a post, refresh the page",
          "expected": "Pinned post should still be pinned and appear at top of stream",
          "actual": "After page refresh, the previously pinned post was NOT pinned anymore - all posts showed Pin links instead of Unpin, no blue pin icons visible",
          "screenshot": "Post Pinning_step05_after_refresh_no_pin.png"
        }
      ],
      "issues": [
        "Pin status does not persist across page refresh - pinned posts lose their pinned state after browser refresh, indicating either database transaction not committed or retrieval bug"
      ]
    }
  ],
  "observations": [
    "Pin functionality UI works correctly in the browser session - posts are pinned, move to top, show blue pin icons, and Pin link changes to Unpin",
    "Code review shows UpdatePinStatus method in ActivityStreamController.cs toggles pin status via stored procedure 'ActivityStream_Toggle_Pin'",
    "Code requires CanModerate permission to access pin functionality (verified in ActivityStreamServicesController.cs line 354)",
    "Pin links are only rendered when _isAdmin is true (verified in ActivityStreamParser.cs line 299)",
    "Unpin API call fails with 500 error - may indicate database or permission issue when toggling off",
    "Pin persistence issue suggests possible database transaction rollback or stored procedure failure"
  ],
  "summary": {
    "total_scenarios": 5,
    "passed": 3,
    "failed": 2,
    "pass_rate": "60%"
  }
}
