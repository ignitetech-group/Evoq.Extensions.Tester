<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Post Deletion - Test Report</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        h2 {
            color: #34495e;
            margin-top: 30px;
        }
        h3 {
            color: #2c3e50;
            margin-top: 20px;
        }
        .feature-info {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .test-case {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .pass {
            color: #27ae60;
            font-weight: bold;
            font-size: 1.2em;
        }
        .fail {
            color: #e74c3c;
            font-weight: bold;
            font-size: 1.2em;
        }
        .status-badge {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            color: white;
            font-weight: bold;
        }
        .status-pass {
            background-color: #27ae60;
        }
        .status-fail {
            background-color: #e74c3c;
        }
        .screenshot {
            max-width: 100%;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin: 10px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .steps {
            background-color: #ecf0f1;
            padding: 15px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .steps ol {
            margin: 0;
            padding-left: 20px;
        }
        .summary {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-top: 30px;
        }
        .summary-stats {
            display: flex;
            gap: 20px;
            margin-top: 15px;
        }
        .stat-box {
            padding: 15px 25px;
            border-radius: 8px;
            text-align: center;
        }
        .stat-pass {
            background-color: #d5f4e6;
            color: #27ae60;
        }
        .stat-fail {
            background-color: #fadbd8;
            color: #e74c3c;
        }
        .observations {
            background-color: #fff3cd;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
            border-left: 4px solid #ffc107;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background-color: #3498db;
            color: white;
        }
        tr:hover {
            background-color: #f5f5f5;
        }
    </style>
</head>
<body>
    <h1>Post Deletion - Test Report</h1>

    <div class="feature-info">
        <h2>Feature Information</h2>
        <table>
            <tr><th>Feature Name</th><td>Post Deletion</td></tr>
            <tr><th>Extension</th><td>Evoq.Social.ActivityStream (Module)</td></tr>
            <tr><th>Priority</th><td>High</td></tr>
            <tr><th>Description</th><td>Soft delete and permanently delete posts from the activity stream</td></tr>
            <tr><th>UI Location</th><td>Activity Stream > Post > Delete Button</td></tr>
            <tr><th>Test Date</th><td>January 6, 2026</td></tr>
            <tr><th>Tested By</th><td>SuperUser Account (host)</td></tr>
        </table>
    </div>

    <div class="summary">
        <h2>Test Summary</h2>
        <div class="summary-stats">
            <div class="stat-box stat-pass">
                <h3>5</h3>
                <p>PASSED</p>
            </div>
            <div class="stat-box stat-fail">
                <h3>0</h3>
                <p>FAILED</p>
            </div>
        </div>
    </div>

    <!-- Test Case 1: Soft Delete Own Post -->
    <div class="test-case">
        <h2>Test Case 1: Soft Delete Own Post</h2>
        <span class="status-badge status-pass">PASS</span>

        <h3>Description</h3>
        <p>Test the ability to delete (soft delete) a post created by the current user.</p>

        <h3>Steps Taken</h3>
        <div class="steps">
            <ol>
                <li>Logged in as SuperUser (host)</li>
                <li>Navigated to Community page (Activity Stream)</li>
                <li>Created a new post by clicking Share (empty post created)</li>
                <li>Clicked "Remove" link on the newly created post</li>
                <li>Confirmed deletion in the dialog by clicking "Yes"</li>
                <li>Verified the post was removed from the feed</li>
            </ol>
        </div>

        <h3>Screenshots</h3>
        <p><strong>Activity Stream before deletion:</strong></p>
        <img src="Post Deletion_step02_before_delete.png" alt="Before Delete" class="screenshot">

        <p><strong>Confirmation dialog:</strong></p>
        <img src="Post Deletion_step04_delete_confirmation.png" alt="Delete Confirmation" class="screenshot">

        <p><strong>After deletion - post removed:</strong></p>
        <img src="Post Deletion_step05_post_deleted.png" alt="Post Deleted" class="screenshot">

        <h3>Result</h3>
        <p class="pass">PASS - Post was successfully deleted and removed from the feed.</p>
    </div>

    <!-- Test Case 2: Verify Deleted Post Removed from Feed -->
    <div class="test-case">
        <h2>Test Case 2: Verify Deleted Post is Removed from Feed</h2>
        <span class="status-badge status-pass">PASS</span>

        <h3>Description</h3>
        <p>Verify that when a post is deleted, it is immediately removed from the activity stream feed.</p>

        <h3>Steps Taken</h3>
        <div class="steps">
            <ol>
                <li>Deleted a post using the Remove button</li>
                <li>Observed the feed immediately after deletion</li>
                <li>Verified the deleted post no longer appears in the feed</li>
            </ol>
        </div>

        <h3>Screenshots</h3>
        <p><strong>Feed after post deletion (post no longer visible):</strong></p>
        <img src="Post Deletion_step05_post_deleted.png" alt="Post Removed from Feed" class="screenshot">

        <h3>Result</h3>
        <p class="pass">PASS - Deleted posts are immediately removed from the activity stream feed.</p>
    </div>

    <!-- Test Case 3: Delete Post as Moderator -->
    <div class="test-case">
        <h2>Test Case 3: Delete Post as Moderator (Other User's Post)</h2>
        <span class="status-badge status-pass">PASS</span>

        <h3>Description</h3>
        <p>Test the ability for a moderator/superuser to delete posts created by other users.</p>

        <h3>Steps Taken</h3>
        <div class="steps">
            <ol>
                <li>Identified a post created by another user (Test User123's badge post)</li>
                <li>Verified the "Remove" link was available on the post</li>
                <li>Clicked "Remove" link on Test User123's post</li>
                <li>Confirmed deletion in the dialog by clicking "Yes"</li>
                <li>Verified the post was removed from the feed</li>
            </ol>
        </div>

        <h3>Screenshots</h3>
        <p><strong>Other user's post with Remove option (as moderator):</strong></p>
        <img src="Post Deletion_step06_other_user_post_before.png" alt="Other User Post" class="screenshot">

        <p><strong>Confirmation dialog for moderator deletion:</strong></p>
        <img src="Post Deletion_step07_moderator_delete_confirm.png" alt="Moderator Delete Confirm" class="screenshot">

        <p><strong>Post successfully deleted:</strong></p>
        <img src="Post Deletion_step08_moderator_delete_success.png" alt="Moderator Delete Success" class="screenshot">

        <h3>Result</h3>
        <p class="pass">PASS - Moderator can successfully delete posts created by other users.</p>
    </div>

    <!-- Test Case 4: Delete Post with Comments -->
    <div class="test-case">
        <h2>Test Case 4: Delete Post with Comments</h2>
        <span class="status-badge status-pass">PASS</span>

        <h3>Description</h3>
        <p>Test deleting a post that has comments attached to it.</p>

        <h3>Steps Taken</h3>
        <div class="steps">
            <ol>
                <li>Identified a post with comments ("Testing Prohibit Content mode" post with a comment)</li>
                <li>Clicked "Remove" link on the post with comments</li>
                <li>Confirmed deletion in the dialog by clicking "Yes"</li>
                <li>Verified the post and its comments were removed from the feed</li>
            </ol>
        </div>

        <h3>Screenshots</h3>
        <p><strong>Post with comments - confirmation dialog:</strong></p>
        <img src="Post Deletion_step09_delete_post_with_comments.png" alt="Delete Post with Comments" class="screenshot">

        <p><strong>Post with comments deleted:</strong></p>
        <img src="Post Deletion_step10_post_with_comments_deleted.png" alt="Post with Comments Deleted" class="screenshot">

        <h3>Result</h3>
        <p class="pass">PASS - Posts with comments can be successfully deleted, and all associated comments are removed.</p>
    </div>

    <!-- Test Case 5: Delete Post with Attachments -->
    <div class="test-case">
        <h2>Test Case 5: Delete Post with Attachments</h2>
        <span class="status-badge status-pass">PASS</span>

        <h3>Description</h3>
        <p>Test deleting a post that has image attachments.</p>

        <h3>Steps Taken</h3>
        <div class="steps">
            <ol>
                <li>Identified a post with image attachments (post with test_image2.png and test_image639026992557805878.png)</li>
                <li>Clicked "Remove" link on the post with attachments</li>
                <li>Confirmed deletion in the dialog by clicking "Yes"</li>
                <li>Verified the post with images was removed from the feed</li>
            </ol>
        </div>

        <h3>Screenshots</h3>
        <p><strong>Post with attachments - confirmation dialog:</strong></p>
        <img src="Post Deletion_step12_attachments_confirm_delete.png" alt="Delete Post with Attachments Confirm" class="screenshot">

        <p><strong>Post with attachments deleted:</strong></p>
        <img src="Post Deletion_step13_attachments_deleted.png" alt="Post with Attachments Deleted" class="screenshot">

        <h3>Result</h3>
        <p class="pass">PASS - Posts with image attachments can be successfully deleted.</p>
    </div>

    <!-- Observations -->
    <div class="observations">
        <h2>Observations</h2>
        <ul>
            <li><strong>Soft Delete vs Permanent Delete:</strong> The code (ActivityStreamServicesController.cs) contains both a <code>Delete</code> method (permanent deletion) and a <code>SoftDelete</code> method. However, the UI only exposes a single "Remove" button which appears to call the permanent Delete method. No UI option was found for soft delete specifically.</li>
            <li><strong>Permission Model:</strong> The code checks three permission conditions for deletion:
                <ul>
                    <li>Post owner (ji.UserId == UserInfo.UserID)</li>
                    <li>Moderator (ActivityModuleSecurity.CanModerate)</li>
                    <li>Wall owner with delete permissions (ji.ProfileId == UserInfo.UserID && HasOwnWallDeletePermissions)</li>
                </ul>
            </li>
            <li><strong>Confirmation Dialog:</strong> All deletion operations show a confirmation dialog "Are you sure you want to delete this item?" before proceeding.</li>
            <li><strong>Immediate Feed Update:</strong> The activity stream feed updates immediately after deletion without requiring a page refresh.</li>
            <li><strong>"Attempt to delete other user's post" scenario:</strong> As a superuser/moderator, we were able to delete other users' posts. Testing with a non-moderator regular user was not performed as the test was run as SuperUser.</li>
        </ul>
    </div>

    <div class="feature-info">
        <h2>Test Environment</h2>
        <table>
            <tr><th>Website URL</th><td>http://localhost:8081</td></tr>
            <tr><th>User Account</th><td>host (SuperUser Account)</td></tr>
            <tr><th>Browser</th><td>Playwright MCP Browser</td></tr>
            <tr><th>Resolution</th><td>1280 x 720</td></tr>
        </table>
    </div>

    <footer style="text-align: center; margin-top: 40px; padding: 20px; color: #7f8c8d;">
        <p>Generated by Evoq Extensions Tester - January 6, 2026</p>
    </footer>
</body>
</html>
