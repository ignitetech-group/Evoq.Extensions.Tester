{
  "metadata": {
    "extension_name": "ContentLayout",
    "extension_type": "Module",
    "feature_name": "Shared Module Restrictions",
    "feature_description": "Enforces restrictions on shared module instances to prevent layout conflicts across pages.",
    "feature_priority": "Medium",
    "test_date": "2026-02-09T15:10:00Z",
    "tester": "Claude"
  },
  "test_scenarios": [
    {
      "scenario_name": "Verify read-only behavior on non-master pages (Code Verification)",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Reviewed View.ascx.cs code for shared module handling",
          "expected": "Code should conditionally hide editor controls for shared modules",
          "actual": "Code at line 256-259 shows EditorScript.Visible is set to true ONLY when !_moduleController.IsSharedModule(ModuleConfiguration), confirming that shared modules will not display editing controls",
          "screenshot": "Shared_Module_Restrictions_step02_contentlayout_module_settings.png"
        },
        {
          "step_number": 2,
          "action": "Verified non-shared ContentLayout module shows editing controls in edit mode",
          "expected": "Non-shared ContentLayout modules should display column size indicators and editing capabilities",
          "actual": "ContentLayout module (364) on Home page shows column size percentages (38%, 12%, 25%, 25%) and editing controls when not shared to other pages",
          "screenshot": "Shared_Module_Restrictions_step01_edit_mode_overview.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Prevent layout changes on shared modules (Code Verification)",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Reviewed ContentLayoutController.cs for shared module restriction logic",
          "expected": "Code should throw an exception when attempting to modify a shared module's layout",
          "actual": "Code at lines 116-119 in UpdateLayoutInternal() method checks _moduleController.IsSharedModule(module) and throws InvalidOperationException with message 'This module does not belong to the page. Please, move to its master page to change the module'",
          "screenshot": "Shared_Module_Restrictions_step02_contentlayout_module_settings.png"
        },
        {
          "step_number": 2,
          "action": "Verified ContentLayout module settings showing module is not shared",
          "expected": "Module settings should show 'Added to Pages' information",
          "actual": "Module 364 (Top Layout) settings show 'This module has not been added to any other pages' in the Added to Pages section, confirming the module is the master instance",
          "screenshot": "Shared_Module_Restrictions_step02_contentlayout_module_settings.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Display appropriate error messages (Code Verification)",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Reviewed error message handling in ContentLayoutController.cs",
          "expected": "Error message should clearly indicate the module is shared and direct user to master page",
          "actual": "Error message is properly localized using Localization.GetExceptionMessage() with key 'ModuleDoesNotBelongToPage' and default text 'This module does not belong to the page. Please, move to its master page to change the module' - This provides clear guidance for users",
          "screenshot": "Shared_Module_Restrictions_step04_edit_mode_with_controls.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Redirect to master page for edits",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Reviewed code for master page redirect behavior",
          "expected": "Error message should guide users to the master page",
          "actual": "The error message explicitly states 'Please, move to its master page to change the module' which guides users to navigate to the original page where the module was created to make layout changes",
          "screenshot": "Shared_Module_Restrictions_step04_edit_mode_with_controls.png"
        }
      ],
      "issues": []
    }
  ],
  "observations": [
    "Code confirms shared module restrictions are implemented at two levels: (1) UI level - EditorScript is hidden for shared modules in View.ascx.cs:256-259, and (2) API level - UpdateLayoutInternal() throws InvalidOperationException for shared modules in ContentLayoutController.cs:116-119",
    "The feature cannot be fully UI-tested without first creating a shared ContentLayout module scenario, which requires using DNN's module sharing functionality to add the same module instance to multiple pages",
    "ContentLayout modules on each page tested (Home and Our Products) are independent instances, not shared modules, as confirmed by the 'Added to Pages' section in module settings",
    "The implementation uses proper localization for error messages, ensuring the feature works correctly across different language configurations",
    "The restriction applies to both UpdateLayoutWithColumnSizes and UpdateLayoutFromTemplate methods, ensuring comprehensive protection against layout changes on shared modules"
  ],
  "summary": {
    "total_scenarios": 4,
    "passed": 4,
    "failed": 0,
    "pass_rate": "100%"
  }
}
