{
  "metadata": {
    "extension_name": "ContentLayout",
    "extension_type": "Module",
    "feature_name": "Layout Versioning",
    "feature_description": "Tracks changes to layouts and maintains version history for rollback and publishing workflows.",
    "feature_priority": "High",
    "test_date": "2026-02-09T15:10:00Z",
    "tester": "Claude"
  },
  "test_scenarios": [
    {
      "scenario_name": "Track layout changes and create version",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Login and navigate to Home page in Edit mode",
          "expected": "Page loads in edit mode with Content Layout modules visible",
          "actual": "Page loaded in edit mode showing Content Layout modules with panes F30A_Pane1-4 and 9977_Pane1-4",
          "screenshot": "Layout Versioning_step01_edit_mode.png"
        },
        {
          "step_number": 2,
          "action": "Click on Content Layout module to view column sizes",
          "expected": "Column sizes should be displayed as percentages",
          "actual": "Column sizes displayed: 33%, 17%, 25%, 25%",
          "screenshot": "Layout Versioning_step04_content_layout_column_sizes.png"
        },
        {
          "step_number": 3,
          "action": "Drag resize handle to change column sizes",
          "expected": "Column sizes should change and trigger version tracking via UpdateLayoutWithColumnSizes API",
          "actual": "Column sizes changed to: 38%, 12%, 25%, 25%. Change was tracked.",
          "screenshot": "Layout Versioning_step06_new_column_sizes.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "View version history",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Click Page History button in edit bar",
          "expected": "Page History panel should open showing list of versions",
          "actual": "Page History panel opened showing Version 3 (Draft) and Version 2 (Published)",
          "screenshot": "Layout Versioning_step08_page_history.png"
        },
        {
          "step_number": 2,
          "action": "Verify version details are displayed",
          "expected": "Each version should show date, user, and state (Draft/Published)",
          "actual": "Version 3 shows Draft state, Version 2 shows Published state, both by SuperUser Account with timestamps",
          "screenshot": "Layout Versioning_step08_page_history.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Compare versions",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Select both Version 3 and Version 2 checkboxes and click Compare",
          "expected": "Version comparison view should open showing differences",
          "actual": "Comparison view opened showing side-by-side comparison with Version 3 on top and Version 2 on bottom, highlighting insertions (teal) and deletions (red)",
          "screenshot": "Layout Versioning_step09_version_comparison.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Publish version",
      "status": "FAIL",
      "steps": [
        {
          "step_number": 1,
          "action": "Click Publish button to publish draft version",
          "expected": "Draft version should be published, becoming the new published version",
          "actual": "Error dialog appeared: 'Another user has taken action on the page and its state has been changed. Please, refresh the page to see the current state.'",
          "screenshot": "Layout Versioning_step07_publish_error.png"
        }
      ],
      "issues": ["Publish operation failed with conflict detection error. This may be due to concurrent page state changes from previous test runs or a versioning state mismatch. The error is a safety mechanism but prevented testing of successful publish."]
    },
    {
      "scenario_name": "Discard changes (Rollback)",
      "status": "FAIL",
      "steps": [
        {
          "step_number": 1,
          "action": "Click Discard button",
          "expected": "Confirmation dialog should appear",
          "actual": "Confirmation dialog appeared asking 'Are you sure you want to discard the changes?'",
          "screenshot": "Layout Versioning_step10_discard_confirmation.png"
        },
        {
          "step_number": 2,
          "action": "Confirm discard to rollback to published version",
          "expected": "Draft version should be discarded and page should revert to last published state",
          "actual": "Error dialog appeared: 'Another user has taken action on the page and its state has been changed. Please, refresh the page to see the current state.'",
          "screenshot": "Layout Versioning_step11_discard_error.png"
        }
      ],
      "issues": ["Discard operation failed with same conflict detection error as Publish. Both Publish and Discard failed due to page state mismatch, possibly from accumulated test changes."]
    },
    {
      "scenario_name": "Verify site versioning settings",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Navigate to Settings > Site Behavior > More to view versioning settings",
          "expected": "Versioning settings should be visible and configurable",
          "actual": "Versioning settings displayed: Enable Page Versioning: On, Maximum Number of Page Versions Kept: 10, Enable File Versioning: On, Maximum Number of File Versions Kept: 5",
          "screenshot": "Layout Versioning_step03_site_versioning_enabled.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Get latest version behavior",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Verify Page History shows correct latest version",
          "expected": "Most recent version should be listed at top with correct state",
          "actual": "Version 3 (Draft) shown as latest version in Page History panel",
          "screenshot": "Layout Versioning_step08_page_history.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Get published version behavior",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Verify Page History shows published version correctly",
          "expected": "Published version should be clearly marked with Published state",
          "actual": "Version 2 shown with 'Published' state in Page History panel",
          "screenshot": "Layout Versioning_step08_page_history.png"
        }
      ],
      "issues": []
    }
  ],
  "observations": [
    "Layout Versioning is tightly integrated with DNN's Page Versioning System (Tab Change Tracker)",
    "Column size changes trigger the UpdateLayoutWithColumnSizes API which calls TrackModuleChange in VersionController",
    "The version comparison feature shows insertions (teal/green) and deletions (red) between versions",
    "Publish and Discard operations show a conflict detection error when the page state has changed. This appears to be a safety mechanism but prevented completion of those tests. Research of the code confirms this is intentional behavior from DnnTabVersionException.",
    "The VersionController uses caching (DataCache) with cache key pattern 'ContentLayoutVersion_{moduleId}_{version}'",
    "Version data includes: ModuleId, Version number, ColumnSizes, ColumnCssClasses, AreCustomColumnSizes, and IsPublished flag",
    "Delete version functionality exists in code (VersionController.DeleteVersion) but no UI control was found to test it directly"
  ],
  "summary": {
    "total_scenarios": 8,
    "passed": 6,
    "failed": 2,
    "pass_rate": "75%"
  }
}
