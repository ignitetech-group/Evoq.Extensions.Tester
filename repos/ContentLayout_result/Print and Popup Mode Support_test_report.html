<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Report: Print and Popup Mode Support - ContentLayout</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .header {
            background: linear-gradient(135deg, #1a5276, #2980b9);
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 30px;
        }
        .header h1 {
            margin: 0 0 10px 0;
        }
        .header .meta {
            opacity: 0.9;
            font-size: 14px;
        }
        .summary-box {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
        }
        .summary-card {
            flex: 1;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            text-align: center;
        }
        .summary-card.pass {
            border-top: 4px solid #27ae60;
        }
        .summary-card.fail {
            border-top: 4px solid #e74c3c;
        }
        .summary-card.total {
            border-top: 4px solid #3498db;
        }
        .summary-card h3 {
            margin: 0;
            font-size: 36px;
        }
        .summary-card p {
            margin: 5px 0 0 0;
            color: #666;
        }
        .test-case {
            background: white;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .test-header {
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #eee;
        }
        .test-header h3 {
            margin: 0;
        }
        .status {
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 14px;
        }
        .status.pass {
            background-color: #d4edda;
            color: #155724;
        }
        .status.fail {
            background-color: #f8d7da;
            color: #721c24;
        }
        .test-body {
            padding: 20px;
        }
        .test-body h4 {
            margin-top: 0;
            color: #333;
        }
        .steps {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
        }
        .steps ol {
            margin: 0;
            padding-left: 20px;
        }
        .steps li {
            margin-bottom: 8px;
        }
        .screenshot {
            margin: 15px 0;
            text-align: center;
        }
        .screenshot img {
            max-width: 100%;
            border: 1px solid #ddd;
            border-radius: 5px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .screenshot p {
            color: #666;
            font-size: 14px;
            margin-top: 8px;
        }
        .observations {
            background: #fff3cd;
            border: 1px solid #ffc107;
            border-radius: 8px;
            padding: 20px;
            margin-top: 30px;
        }
        .observations h2 {
            margin-top: 0;
            color: #856404;
        }
        .code-ref {
            background: #e9ecef;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: monospace;
            font-size: 13px;
        }
        .feature-info {
            background: #e3f2fd;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
        }
        .feature-info h2 {
            margin-top: 0;
            color: #1565c0;
        }
        .comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        .comparison-item {
            text-align: center;
        }
        .comparison-item img {
            max-width: 100%;
            border: 2px solid #ddd;
            border-radius: 5px;
        }
        .comparison-item.highlight img {
            border-color: #27ae60;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Test Report: Print and Popup Mode Support</h1>
        <div class="meta">
            <strong>Extension:</strong> ContentLayout (Module) |
            <strong>Priority:</strong> Low (SMOKE Testing) |
            <strong>Feature:</strong> 14 of 15 |
            <strong>Date:</strong> January 6, 2026
        </div>
    </div>

    <div class="feature-info">
        <h2>Feature Description</h2>
        <p><strong>Feature Name:</strong> Print and Popup Mode Support</p>
        <p><strong>Description:</strong> Handles special rendering modes for print view and popup windows. When accessing pages with <code class="code-ref">?dnnprintmode=true</code> or <code class="code-ref">?popUp=true</code> query parameters, the ContentLayout module hides edit controls while preserving the content layout.</p>
        <p><strong>UI Location:</strong> Page Print View / Popup Windows</p>
        <p><strong>Relevant Files:</strong> <code class="code-ref">Evoq Content/Modules/ContentLayout/View.ascx.cs</code></p>
        <p><strong>Key Code:</strong> The <code class="code-ref">IsSpecialPageMode</code> property (line 78-84) detects special modes, and <code class="code-ref">RegisterResources</code> method (line 247-262) conditionally loads edit controls only when NOT in special page mode.</p>
    </div>

    <div class="summary-box">
        <div class="summary-card total">
            <h3>3</h3>
            <p>Total Tests</p>
        </div>
        <div class="summary-card pass">
            <h3>3</h3>
            <p>Passed</p>
        </div>
        <div class="summary-card fail">
            <h3>0</h3>
            <p>Failed</p>
        </div>
    </div>

    <!-- Test Case 1: Print Mode Rendering -->
    <div class="test-case">
        <div class="test-header">
            <h3>Test 1: Print Mode Rendering</h3>
            <span class="status pass">PASS</span>
        </div>
        <div class="test-body">
            <h4>Objective</h4>
            <p>Verify that print mode (<code class="code-ref">?dnnprintmode=true</code>) renders the page without edit controls while preserving content layout.</p>

            <div class="steps">
                <h4>Steps Taken</h4>
                <ol>
                    <li>Logged in as SuperUser (host/Pass123456)</li>
                    <li>Navigated to homepage in normal mode to verify admin sidebar is visible</li>
                    <li>Navigated to <code class="code-ref">http://localhost:8081/en-us/?dnnprintmode=true</code></li>
                    <li>Verified that admin sidebar (persona bar) is NOT displayed</li>
                    <li>Verified that page content is preserved and displayed correctly</li>
                </ol>
            </div>

            <h4>Evidence</h4>
            <div class="comparison">
                <div class="comparison-item">
                    <img src="Print_and_Popup_Mode_Support_step02_normal_mode_with_admin_sidebar.png" alt="Normal Mode with Admin Sidebar">
                    <p><strong>Normal Mode:</strong> Admin sidebar visible (left side)</p>
                </div>
                <div class="comparison-item highlight">
                    <img src="Print_and_Popup_Mode_Support_step01_print_mode.png" alt="Print Mode - No Admin Controls">
                    <p><strong>Print Mode:</strong> No admin sidebar - edit controls hidden</p>
                </div>
            </div>

            <h4>Result</h4>
            <p><strong>PASS</strong> - Print mode correctly hides the admin sidebar/persona bar while preserving all page content including navigation, hero section, and product categories.</p>
        </div>
    </div>

    <!-- Test Case 2: Popup Mode Rendering -->
    <div class="test-case">
        <div class="test-header">
            <h3>Test 2: Popup Mode Rendering</h3>
            <span class="status pass">PASS</span>
        </div>
        <div class="test-body">
            <h4>Objective</h4>
            <p>Verify that popup mode (<code class="code-ref">?popUp=true</code>) renders the page in a simplified view suitable for popup windows.</p>

            <div class="steps">
                <h4>Steps Taken</h4>
                <ol>
                    <li>Navigated to <code class="code-ref">http://localhost:8081/en-us/?popUp=true</code></li>
                    <li>Verified that admin sidebar (persona bar) is NOT displayed</li>
                    <li>Verified that navigation header is NOT displayed</li>
                    <li>Verified that only content modules are rendered</li>
                    <li>Noted page title changed to popup format: "My Website > Home (Trial)"</li>
                </ol>
            </div>

            <h4>Evidence</h4>
            <div class="screenshot">
                <img src="Print_and_Popup_Mode_Support_step03_popup_mode.png" alt="Popup Mode - Stripped Down View">
                <p><strong>Popup Mode:</strong> Stripped-down view showing only content modules - no navigation, no header, no admin controls</p>
            </div>

            <h4>Result</h4>
            <p><strong>PASS</strong> - Popup mode correctly displays a simplified view with only content modules, removing navigation, headers, and admin controls. This is ideal for popup windows.</p>
        </div>
    </div>

    <!-- Test Case 3: Edit Controls Hidden in Special Modes -->
    <div class="test-case">
        <div class="test-header">
            <h3>Test 3: Edit Controls Hidden in Special Modes</h3>
            <span class="status pass">PASS</span>
        </div>
        <div class="test-body">
            <h4>Objective</h4>
            <p>Verify that edit controls (Layout Editor, Editor Script) are NOT loaded in special page modes.</p>

            <div class="steps">
                <h4>Steps Taken</h4>
                <ol>
                    <li>Compared normal mode page (shows admin sidebar with Dashboard, Content, Manage, Page Analytics, Settings, Edit buttons)</li>
                    <li>Verified print mode page does NOT have admin sidebar or edit controls</li>
                    <li>Verified popup mode page does NOT have admin sidebar or edit controls</li>
                    <li>Confirmed layout content is preserved in both special modes</li>
                </ol>
            </div>

            <h4>Code Reference</h4>
            <p>The <code class="code-ref">RegisterResources</code> method in <code class="code-ref">View.ascx.cs</code> (lines 247-262) controls this behavior:</p>
            <pre style="background: #f4f4f4; padding: 15px; border-radius: 5px; overflow-x: auto; font-size: 13px;">
if (InEditMode && !IsSpecialPageMode && TabPermissionController.CanAddContentToPage())
{
    ClientResourceManager.RegisterScript(Page, Path.Combine(ControlPath, "ClientScripts/LayoutEditor.js"));
    ClientResourceManager.RegisterStyleSheet(Page, Path.Combine(ControlPath, "Css/LayoutEditor.css"));
}

if (InEditMode && !IsSpecialPageMode && CanEdit && !_moduleController.IsSharedModule(ModuleConfiguration))
{
    EditorScript.Visible = true;
}</pre>
            <p>The <code class="code-ref">!IsSpecialPageMode</code> condition ensures edit resources are NOT loaded when <code class="code-ref">dnnprintmode=true</code> or <code class="code-ref">popUp=true</code>.</p>

            <h4>Result</h4>
            <p><strong>PASS</strong> - Edit controls are correctly hidden in both print mode and popup mode while remaining visible in normal mode.</p>
        </div>
    </div>

    <!-- Observations Section -->
    <div class="observations">
        <h2>Observations</h2>
        <ul>
            <li><strong>URL Rewriting:</strong> DNN rewrites the query string <code class="code-ref">?dnnprintmode=true</code> to a friendly URL format <code class="code-ref">/dnnprintmode/true</code>. The feature still works correctly as the code checks <code class="code-ref">Request.QueryString["dnnprintmode"]</code>.</li>
            <li><strong>Print Mode vs Popup Mode:</strong> Print mode preserves the full page layout (navigation, header) but removes admin controls. Popup mode is more aggressive, removing navigation and headers to show only content modules - suitable for iframe embedding or popup windows.</li>
            <li><strong>Layout Preservation:</strong> The ContentLayout module's column structure and content arrangement are preserved in both special modes, ensuring print output and popup views display content correctly.</li>
            <li><strong>User Authentication:</strong> Special modes do not affect user authentication - logged-in users remain logged in, but edit capabilities are disabled.</li>
        </ul>
    </div>

    <footer style="text-align: center; margin-top: 40px; padding: 20px; color: #666; font-size: 14px;">
        <p>Test Report Generated: January 6, 2026 | ContentLayout Extension Testing | Evoq Extensions Tester</p>
    </footer>
</body>
</html>
