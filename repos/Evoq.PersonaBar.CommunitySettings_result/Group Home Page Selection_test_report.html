<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Report: Group Home Page Selection</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 30px;
        }
        .header h1 {
            margin: 0 0 10px 0;
        }
        .header p {
            margin: 5px 0;
            opacity: 0.9;
        }
        .summary-box {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
        }
        .summary-item {
            flex: 1;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            text-align: center;
        }
        .summary-item.pass {
            border-left: 5px solid #28a745;
        }
        .summary-item.fail {
            border-left: 5px solid #dc3545;
        }
        .summary-item.warning {
            border-left: 5px solid #ffc107;
        }
        .summary-item h3 {
            margin: 0;
            font-size: 2em;
        }
        .test-scenario {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .test-scenario h2 {
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .status-badge {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: bold;
        }
        .status-pass {
            background: #d4edda;
            color: #155724;
        }
        .status-fail {
            background: #f8d7da;
            color: #721c24;
        }
        .status-warning {
            background: #fff3cd;
            color: #856404;
        }
        .steps {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
        }
        .steps ol {
            margin: 0;
            padding-left: 20px;
        }
        .steps li {
            margin-bottom: 8px;
        }
        .screenshot {
            margin: 15px 0;
            text-align: center;
        }
        .screenshot img {
            max-width: 100%;
            border: 1px solid #ddd;
            border-radius: 5px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .screenshot figcaption {
            margin-top: 10px;
            color: #666;
            font-style: italic;
        }
        .observations {
            background: #e7f3ff;
            border-left: 4px solid #0066cc;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 5px 5px 0;
        }
        .bug-report {
            background: #fff5f5;
            border-left: 4px solid #dc3545;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 5px 5px 0;
        }
        .bug-report h4 {
            color: #dc3545;
            margin-top: 0;
        }
        .code-info {
            background: #282c34;
            color: #abb2bf;
            padding: 15px;
            border-radius: 5px;
            font-family: 'Consolas', monospace;
            font-size: 0.9em;
            overflow-x: auto;
        }
        .footer {
            text-align: center;
            padding: 20px;
            color: #666;
            border-top: 1px solid #ddd;
            margin-top: 30px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Test Report: Group Home Page Selection</h1>
        <p><strong>Extension:</strong> Evoq.PersonaBar.CommunitySettings (PersonaBar Module)</p>
        <p><strong>Feature:</strong> Group Home Page Selection</p>
        <p><strong>Priority:</strong> Medium</p>
        <p><strong>Test Date:</strong> December 30, 2025</p>
        <p><strong>UI Location:</strong> Admin > Settings > Community Settings > Settings tab</p>
    </div>

    <div class="summary-box">
        <div class="summary-item pass">
            <h3>4</h3>
            <p>Passed</p>
        </div>
        <div class="summary-item fail">
            <h3>1</h3>
            <p>Failed</p>
        </div>
        <div class="summary-item warning">
            <h3>1</h3>
            <p>Bug Found</p>
        </div>
    </div>

    <div class="test-scenario">
        <h2>Feature Description</h2>
        <p>The Group Home Page Selection feature allows administrators to select the default landing page for group spaces from dynamically loaded group tabs. This setting determines which page users see when they first visit a group.</p>

        <h3>Code Implementation</h3>
        <div class="code-info">
            <strong>Relevant Files:</strong><br>
            - Services/CommunitySettingsController.cs (GetSettings, SaveSettings APIs)<br>
            - admin/personaBar/scripts/CommunitySettings.js (settingsViewModel.groupHomePage, settingsViewModel.groupPages)<br><br>
            <strong>Key Code:</strong><br>
            - Line 319: groupHomePage: ko.observable(0) - Default value<br>
            - Line 318: groupPages: ko.observableArray([]) - Available pages<br>
            - Lines 331-400: getSettings() - Fetches settings from API<br>
            - Lines 422-454: saveSettings() - Saves GroupHomePage to backend
        </div>
    </div>

    <div class="test-scenario">
        <h2>Test Scenario 1: Verify Dropdown Populates with Available Group Tabs <span class="status-badge status-pass">PASS</span></h2>
        <div class="steps">
            <ol>
                <li>Navigate to Admin > Settings > Community Settings</li>
                <li>Locate the Group Home Page dropdown under Miscellaneous Community Settings</li>
                <li>Click on the dropdown to expand options</li>
                <li>Verify all group tabs are listed</li>
            </ol>
        </div>
        <div class="screenshot">
            <figure>
                <img src="Group_Home_Page_Selection_step01_initial_state.png" alt="Initial state showing Community Settings">
                <figcaption>Step 1: Community Settings panel with Group Home Page dropdown visible</figcaption>
            </figure>
        </div>
        <div class="screenshot">
            <figure>
                <img src="Group_Home_Page_Selection_step02_dropdown_expanded.png" alt="Dropdown expanded showing all options">
                <figcaption>Step 2: Dropdown expanded showing all 8 available group tabs</figcaption>
            </figure>
        </div>
        <div class="observations">
            <strong>Result:</strong> The dropdown correctly populates with 8 group tabs:
            <ul>
                <li>Activity</li>
                <li>Answers</li>
                <li>Blogs</li>
                <li>Discussions</li>
                <li>Events</li>
                <li>Ideas</li>
                <li>Members</li>
                <li>Wiki</li>
            </ul>
        </div>
    </div>

    <div class="test-scenario">
        <h2>Test Scenario 2: Select a Group Home Page from Dropdown <span class="status-badge status-pass">PASS</span></h2>
        <div class="steps">
            <ol>
                <li>Click on the Group Home Page dropdown</li>
                <li>Select "Discussions" from the list</li>
                <li>Verify the selection is displayed in the dropdown</li>
            </ol>
        </div>
        <div class="screenshot">
            <figure>
                <img src="Group_Home_Page_Selection_step03_discussions_selected.png" alt="Discussions selected">
                <figcaption>Discussions successfully selected from the dropdown</figcaption>
            </figure>
        </div>
        <div class="observations">
            <strong>Result:</strong> Selection functionality works correctly. User can select any option from the dropdown.
        </div>
    </div>

    <div class="test-scenario">
        <h2>Test Scenario 3: Save Group Home Page Selection <span class="status-badge status-pass">PASS</span></h2>
        <div class="steps">
            <ol>
                <li>After selecting a value, click the Save button</li>
                <li>Observe the success message</li>
            </ol>
        </div>
        <div class="screenshot">
            <figure>
                <img src="Group_Home_Page_Selection_step04_save_success.png" alt="Save success">
                <figcaption>Settings saved - "Discussions" selected and saved successfully</figcaption>
            </figure>
        </div>
        <div class="screenshot">
            <figure>
                <img src="Group_Home_Page_Selection_step07_wiki_save_success.png" alt="Wiki save success">
                <figcaption>Second save test - "Wiki" selected and saved with success notification</figcaption>
            </figure>
        </div>
        <div class="observations">
            <strong>Result:</strong> Save functionality works. The system displays "Item successfully saved." confirmation message.
        </div>
    </div>

    <div class="test-scenario">
        <h2>Test Scenario 4: Verify Persistence After Navigation <span class="status-badge status-fail">FAIL</span></h2>
        <div class="steps">
            <ol>
                <li>Select "Wiki" as the Group Home Page</li>
                <li>Click Save and confirm success message appears</li>
                <li>Navigate away from Community Settings (to Dashboard)</li>
                <li>Navigate back to Community Settings</li>
                <li>Check if "Wiki" is still selected</li>
            </ol>
        </div>
        <div class="screenshot">
            <figure>
                <img src="Group_Home_Page_Selection_step06_wiki_selected.png" alt="Wiki selected before save">
                <figcaption>Step 1-2: "Wiki" selected and ready to save</figcaption>
            </figure>
        </div>
        <div class="screenshot">
            <figure>
                <img src="Group_Home_Page_Selection_step08_persistence_failed.png" alt="Persistence failed">
                <figcaption>Step 5: After navigating back - Dropdown shows "Activity" instead of "Wiki"</figcaption>
            </figure>
        </div>

        <div class="bug-report">
            <h4>BUG FOUND: Settings Do Not Persist</h4>
            <p><strong>Severity:</strong> High</p>
            <p><strong>Description:</strong> The Group Home Page selection does not persist after navigating away from the Community Settings page. Despite receiving a "Item successfully saved." confirmation, the setting reverts to "Activity" (appears to be the default) when the user navigates away and returns.</p>
            <p><strong>Steps to Reproduce:</strong></p>
            <ol>
                <li>Go to Settings > Community</li>
                <li>Change Group Home Page from "Activity" to any other value (e.g., "Wiki")</li>
                <li>Click Save - observe success message</li>
                <li>Navigate to Dashboard or any other section</li>
                <li>Return to Settings > Community</li>
                <li>Observe: Group Home Page shows "Activity" instead of the saved value</li>
            </ol>
            <p><strong>Expected Result:</strong> The saved value should persist and be displayed when returning to the settings page.</p>
            <p><strong>Actual Result:</strong> The value reverts to what appears to be a default value ("Activity") regardless of what was saved.</p>
            <p><strong>Possible Causes:</strong></p>
            <ul>
                <li>The SaveSettings API may not be correctly persisting the GroupHomePage value to the database</li>
                <li>The GetSettings API may not be correctly retrieving the GroupHomePage value</li>
                <li>There may be a mismatch between the key/value format expected by the save and retrieve operations</li>
            </ul>
        </div>
    </div>

    <div class="test-scenario">
        <h2>Test Scenario 5: Verify Default Value <span class="status-badge status-pass">PASS</span></h2>
        <div class="steps">
            <ol>
                <li>Observe the initial value in the Group Home Page dropdown when loading Community Settings</li>
            </ol>
        </div>
        <div class="observations">
            <strong>Result:</strong> The default value displayed is "Activity" which corresponds to the first option in the dropdown. Per the code (line 375: <code>groupHomePage = data.Setting.GroupHomePage || 0</code>), the default value is 0 when no selection has been made. The UI maps this to the first available group tab.
        </div>
    </div>

    <div class="test-scenario">
        <h2>Summary of Findings</h2>
        <table style="width: 100%; border-collapse: collapse; margin: 15px 0;">
            <thead>
                <tr style="background: #f8f9fa;">
                    <th style="padding: 12px; text-align: left; border-bottom: 2px solid #dee2e6;">Test Case</th>
                    <th style="padding: 12px; text-align: center; border-bottom: 2px solid #dee2e6;">Status</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td style="padding: 12px; border-bottom: 1px solid #dee2e6;">Dropdown populates with available group tabs</td>
                    <td style="padding: 12px; text-align: center; border-bottom: 1px solid #dee2e6;"><span class="status-badge status-pass">PASS</span></td>
                </tr>
                <tr>
                    <td style="padding: 12px; border-bottom: 1px solid #dee2e6;">Select a group home page from dropdown</td>
                    <td style="padding: 12px; text-align: center; border-bottom: 1px solid #dee2e6;"><span class="status-badge status-pass">PASS</span></td>
                </tr>
                <tr>
                    <td style="padding: 12px; border-bottom: 1px solid #dee2e6;">Save group home page selection (immediate)</td>
                    <td style="padding: 12px; text-align: center; border-bottom: 1px solid #dee2e6;"><span class="status-badge status-pass">PASS</span></td>
                </tr>
                <tr>
                    <td style="padding: 12px; border-bottom: 1px solid #dee2e6;">Verify persistence after navigation</td>
                    <td style="padding: 12px; text-align: center; border-bottom: 1px solid #dee2e6;"><span class="status-badge status-fail">FAIL</span></td>
                </tr>
                <tr>
                    <td style="padding: 12px; border-bottom: 1px solid #dee2e6;">Verify default value behavior</td>
                    <td style="padding: 12px; text-align: center; border-bottom: 1px solid #dee2e6;"><span class="status-badge status-pass">PASS</span></td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class="test-scenario">
        <h2>Recommendations</h2>
        <ol>
            <li><strong>Investigate SaveSettings API:</strong> Debug the CommunitySettingsController.SaveSettings method to verify the GroupHomePage value is being correctly persisted to the CmxSettings in the database.</li>
            <li><strong>Check Database Storage:</strong> Verify the database table/settings store to confirm whether the GroupHomePage value is actually being saved.</li>
            <li><strong>Review GetSettings API:</strong> Ensure the GetSettings API is correctly retrieving and returning the GroupHomePage value from storage.</li>
            <li><strong>Test with Browser Network Tab:</strong> Monitor the actual API requests/responses to see what data is being sent on save and received on load.</li>
        </ol>
    </div>

    <div class="footer">
        <p>Test Report Generated: December 30, 2025</p>
        <p>Extension: Evoq.PersonaBar.CommunitySettings | Feature: Group Home Page Selection</p>
    </div>
</body>
</html>
