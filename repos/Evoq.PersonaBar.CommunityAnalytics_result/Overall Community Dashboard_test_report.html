<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Report: Overall Community Dashboard</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        h1 {
            color: #333;
            border-bottom: 3px solid #0066cc;
            padding-bottom: 10px;
        }
        h2 {
            color: #444;
            margin-top: 30px;
        }
        h3 {
            color: #555;
        }
        .feature-info {
            background-color: #fff;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }
        .feature-info dt {
            font-weight: bold;
            color: #333;
        }
        .feature-info dd {
            margin-left: 0;
            margin-bottom: 10px;
            color: #666;
        }
        .test-case {
            background-color: #fff;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }
        .status {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 4px;
            font-weight: bold;
            text-transform: uppercase;
        }
        .status-pass {
            background-color: #28a745;
            color: white;
        }
        .status-fail {
            background-color: #dc3545;
            color: white;
        }
        .screenshot {
            max-width: 100%;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin: 10px 0;
        }
        .steps {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .steps ol {
            margin: 0;
            padding-left: 20px;
        }
        .error-box {
            background-color: #fff3cd;
            border: 1px solid #ffc107;
            border-radius: 4px;
            padding: 15px;
            margin: 10px 0;
        }
        .critical-bug {
            background-color: #f8d7da;
            border: 2px solid #dc3545;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        .critical-bug h3 {
            color: #dc3545;
            margin-top: 0;
        }
        code {
            background-color: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
        }
        pre {
            background-color: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
        }
        .summary-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        .summary-table th, .summary-table td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        .summary-table th {
            background-color: #0066cc;
            color: white;
        }
        .summary-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        .observations {
            background-color: #e7f3ff;
            border: 1px solid #0066cc;
            border-radius: 8px;
            padding: 20px;
            margin-top: 30px;
        }
    </style>
</head>
<body>
    <h1>Test Report: Overall Community Dashboard</h1>

    <div class="feature-info">
        <h2>Feature Information</h2>
        <dl>
            <dt>Extension:</dt>
            <dd>Evoq.PersonaBar.CommunityAnalytics (PersonaBar Module)</dd>

            <dt>Feature Name:</dt>
            <dd>Overall Community Dashboard</dd>

            <dt>Description:</dt>
            <dd>Main analytics dashboard showing overall community metrics including user engagement, content creation, and activity trends</dd>

            <dt>UI Location:</dt>
            <dd>PersonaBar > Dashboard > Community Analytics</dd>

            <dt>Feature Priority:</dt>
            <dd>Top</dd>

            <dt>Test Date:</dt>
            <dd>January 6, 2026</dd>
        </dl>
    </div>

    <div class="critical-bug">
        <h3>CRITICAL BUG DISCOVERED</h3>
        <p><strong>The Community Analytics dashboard fails to load completely due to a JavaScript error.</strong></p>
        <p><strong>Error:</strong></p>
        <pre>TypeError: utility.serializeCustomDate is not a function
    at dashboardClass.init (social-dashboard-combined-instance.js:1025:39)</pre>
        <p><strong>Impact:</strong> All test scenarios for this feature cannot be executed via UI because the dashboard panel renders blank/empty. The error occurs immediately when attempting to access Community Analytics from PersonaBar > Dashboard.</p>
        <p><strong>Root Cause:</strong> The file <code>social-dashboard-combined-instance.js</code> at line 1025 calls <code>utility.serializeCustomDate()</code>, but this function does not exist on the utility object. This appears to be a missing dependency or version mismatch with the PersonaBar.UI framework.</p>
        <p><strong>Comparison:</strong> Site Analytics (also under Dashboard) loads correctly, confirming the issue is specific to Community Analytics.</p>
    </div>

    <h2>Test Summary</h2>
    <table class="summary-table">
        <thead>
            <tr>
                <th>Test Scenario</th>
                <th>Status</th>
                <th>Notes</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Access Community Analytics Dashboard</td>
                <td><span class="status status-fail">FAIL</span></td>
                <td>JavaScript error prevents dashboard from loading</td>
            </tr>
            <tr>
                <td>View dashboard with different time periods (daily, weekly, monthly, yearly)</td>
                <td><span class="status status-fail">FAIL</span></td>
                <td>Cannot test - dashboard does not load</td>
            </tr>
            <tr>
                <td>Compare metrics between two time periods</td>
                <td><span class="status status-fail">FAIL</span></td>
                <td>Cannot test - dashboard does not load</td>
            </tr>
            <tr>
                <td>Verify metrics calculation accuracy</td>
                <td><span class="status status-fail">FAIL</span></td>
                <td>Cannot test - dashboard does not load</td>
            </tr>
            <tr>
                <td>Test dashboard loading with no data</td>
                <td><span class="status status-fail">FAIL</span></td>
                <td>Cannot test - dashboard does not load</td>
            </tr>
            <tr>
                <td>Verify dashboard refreshes with new data</td>
                <td><span class="status status-fail">FAIL</span></td>
                <td>Cannot test - dashboard does not load</td>
            </tr>
            <tr>
                <td>Test responsive layout on different screen sizes</td>
                <td><span class="status status-fail">FAIL</span></td>
                <td>Cannot test - dashboard does not load</td>
            </tr>
        </tbody>
    </table>

    <h2>Detailed Test Results</h2>

    <div class="test-case">
        <h3>Test 1: Access Community Analytics Dashboard</h3>
        <p><span class="status status-fail">FAIL</span></p>

        <h4>What was tested:</h4>
        <p>Attempting to access the Community Analytics dashboard via PersonaBar > Dashboard > Community Analytics</p>

        <div class="steps">
            <h4>Steps taken:</h4>
            <ol>
                <li>Logged in as SuperUser (host/Pass123456)</li>
                <li>Clicked on Dashboard icon in PersonaBar</li>
                <li>Hovered to reveal sub-menu showing "Site Analytics" and "Community Analytics"</li>
                <li>Clicked on "Community Analytics"</li>
            </ol>
        </div>

        <h4>Expected Result:</h4>
        <p>Community Analytics dashboard should load showing community metrics, user engagement data, content creation statistics, and activity trends.</p>

        <h4>Actual Result:</h4>
        <p>The dashboard panel appears blank/empty. A JavaScript error is thrown in the console preventing the dashboard from initializing.</p>

        <div class="error-box">
            <strong>Console Error:</strong>
            <pre>TypeError: utility.serializeCustomDate is not a function
    at dashboardClass.init (social-dashboard-combined-instance.js:1025:39)
    at Object.init (social-dashboard-combined.js:16:23)
    at extension.js:104:32</pre>
        </div>

        <h4>Screenshots:</h4>
        <p><strong>Login Confirmed (Setup):</strong></p>
        <img src="Overall_Community_Dashboard_step00_login_confirmed.png" alt="Login Confirmed" class="screenshot">

        <p><strong>Community Analytics Panel - Blank due to JS Error:</strong></p>
        <img src="Overall_Community_Dashboard_step02_blank_panel.png" alt="Blank Panel with JS Error" class="screenshot">

        <p><strong>First attempt showing blank panel:</strong></p>
        <img src="Overall_Community_Dashboard_step01_js_error.png" alt="JS Error Result" class="screenshot">
    </div>

    <div class="test-case">
        <h3>Test 2: Comparison - Site Analytics Works Correctly</h3>
        <p><span class="status status-pass">PASS</span> (for comparison purposes)</p>

        <h4>What was tested:</h4>
        <p>Accessing Site Analytics (sibling feature under Dashboard) to verify if the issue is specific to Community Analytics</p>

        <div class="steps">
            <h4>Steps taken:</h4>
            <ol>
                <li>From Dashboard sub-menu, clicked on "Site Analytics"</li>
                <li>Observed the dashboard loading</li>
            </ol>
        </div>

        <h4>Result:</h4>
        <p>Site Analytics loads correctly with:</p>
        <ul>
            <li>Date range selector (Tue Dec 30 2025 - Tue Jan 06 2026)</li>
            <li>Summary and Traffic tabs</li>
            <li>Insights section</li>
            <li>Top Fives section</li>
            <li>Warning about Google Analytics not being configured (expected for test environment)</li>
        </ul>
        <p>This confirms the JavaScript error is <strong>specific to Community Analytics</strong>, not a general PersonaBar issue.</p>

        <h4>Screenshot:</h4>
        <img src="Overall_Community_Dashboard_step03_site_analytics_works.png" alt="Site Analytics Works" class="screenshot">
    </div>

    <div class="test-case">
        <h3>Tests 3-7: All Remaining Test Scenarios</h3>
        <p><span class="status status-fail">FAIL</span></p>

        <h4>Test Scenarios Not Executable:</h4>
        <ul>
            <li>View dashboard with different time periods (daily, weekly, monthly, yearly)</li>
            <li>Compare metrics between two time periods</li>
            <li>Verify metrics calculation accuracy</li>
            <li>Test dashboard loading with no data</li>
            <li>Verify dashboard refreshes with new data</li>
            <li>Test responsive layout on different screen sizes</li>
        </ul>

        <h4>Reason:</h4>
        <p>All these test scenarios require the Community Analytics dashboard to be accessible and functional. Since the dashboard fails to load due to the JavaScript error, none of these scenarios can be tested via the UI.</p>
    </div>

    <div class="observations">
        <h2>Observations</h2>
        <ul>
            <li><strong>Code Analysis:</strong> The error originates from <code>social-dashboard-combined-instance.js</code> line 1025, which attempts to call <code>utility.serializeCustomDate(new Date(new Date().toUTCString()))</code>. This function is expected to exist on the PersonaBar utility object but is not present.</li>
            <li><strong>Dependency Issue:</strong> The <code>serializeCustomDate</code> and <code>deserializeCustomDate</code> functions are used extensively throughout the Community Analytics JavaScript files (found in analytics.js, social-dashboard-combined-instance.js, social-dashboard-instance.js) but are not defined within this module. They should be provided by the PersonaBar.UI framework.</li>
            <li><strong>API Endpoints Exist:</strong> The backend API controller (<code>Services/CommunityAnalyticsController.cs</code>) has endpoints for:
                <ul>
                    <li>GetDashboardInfo - with period, comparativeTerm, startDate, endDate parameters</li>
                    <li>GetTagStats - with pagination support</li>
                    <li>GetPopularContent - with pagination support</li>
                    <li>GetModuleDashboardInfo - for specific module analytics (Answers, Blogs, Discussions, etc.)</li>
                </ul>
                These endpoints cannot be tested via UI due to the frontend error.
            </li>
            <li><strong>Sub-modules:</strong> The Community Analytics has sub-sections for Answers, Blogs, Discussions, Social Events, Ideas, and Wiki - none of which can be accessed due to the loading failure.</li>
            <li><strong>Permissions:</strong> The module is configured for Administrators and Community Manager roles. Permission testing cannot be performed.</li>
        </ul>
    </div>

    <h2>Recommendations</h2>
    <ol>
        <li><strong>Fix Critical Bug:</strong> Implement the <code>serializeCustomDate</code> function in the utility module, or update the Community Analytics scripts to use an alternative date serialization method.</li>
        <li><strong>Verify Dependencies:</strong> Check version compatibility between Evoq.PersonaBar.CommunityAnalytics and Dnn.PersonaBar.UI packages.</li>
        <li><strong>Re-test After Fix:</strong> Once the JavaScript error is resolved, all test scenarios should be re-executed to validate the Community Analytics functionality.</li>
    </ol>

    <footer style="margin-top: 40px; padding-top: 20px; border-top: 1px solid #ddd; color: #666;">
        <p>Test Report generated on January 6, 2026</p>
        <p>Tester: Automated Testing via Playwright MCP</p>
    </footer>
</body>
</html>
