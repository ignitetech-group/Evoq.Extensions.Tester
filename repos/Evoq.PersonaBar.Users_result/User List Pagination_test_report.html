<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User List Pagination - Test Report</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        h1 {
            color: #333;
            border-bottom: 3px solid #0078d4;
            padding-bottom: 10px;
        }
        h2 {
            color: #444;
            margin-top: 30px;
        }
        .feature-info {
            background-color: #e8f4fd;
            border-left: 4px solid #0078d4;
            padding: 15px;
            margin: 20px 0;
        }
        .test-scenario {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .status {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            text-transform: uppercase;
            font-size: 12px;
        }
        .status-pass {
            background-color: #d4edda;
            color: #155724;
        }
        .status-fail {
            background-color: #f8d7da;
            color: #721c24;
        }
        .screenshot {
            max-width: 100%;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin: 15px 0;
        }
        .steps {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .steps ol {
            margin: 0;
            padding-left: 20px;
        }
        .issue {
            background-color: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 15px 0;
        }
        .observations {
            background-color: #e7f3ff;
            border: 1px solid #b8daff;
            border-radius: 8px;
            padding: 20px;
            margin: 30px 0;
        }
        .summary-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        .summary-table th, .summary-table td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        .summary-table th {
            background-color: #0078d4;
            color: white;
        }
        .summary-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }
    </style>
</head>
<body>
    <h1>User List Pagination - Test Report</h1>

    <div class="feature-info">
        <h3>Feature Information</h3>
        <p><strong>Extension:</strong> Evoq.PersonaBar.Users</p>
        <p><strong>Feature:</strong> User List Pagination</p>
        <p><strong>Description:</strong> Navigate through paginated list of users with configurable page sizes</p>
        <p><strong>UI Location:</strong> Admin &gt; Users &gt; Pagination Controls</p>
        <p><strong>Test Date:</strong> January 6, 2026</p>
        <p><strong>Testing Depth:</strong> THOROUGH (High Priority)</p>
    </div>

    <h2>Test Summary</h2>
    <table class="summary-table">
        <thead>
            <tr>
                <th>Test Scenario</th>
                <th>Status</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Default page size is 10</td>
                <td><span class="status status-pass">PASS</span></td>
            </tr>
            <tr>
                <td>Navigate to next page</td>
                <td><span class="status status-pass">PASS</span></td>
            </tr>
            <tr>
                <td>Navigate to previous page</td>
                <td><span class="status status-pass">PASS</span></td>
            </tr>
            <tr>
                <td>Test first/last page boundaries</td>
                <td><span class="status status-pass">PASS</span></td>
            </tr>
            <tr>
                <td>Change page size (10, 25)</td>
                <td><span class="status status-pass">PASS</span></td>
            </tr>
            <tr>
                <td>Verify total users count display</td>
                <td><span class="status status-pass">PASS</span></td>
            </tr>
            <tr>
                <td>Verify current page indicator</td>
                <td><span class="status status-pass">PASS</span></td>
            </tr>
            <tr>
                <td>Pagination resets on filter change</td>
                <td><span class="status status-fail">FAIL</span></td>
            </tr>
        </tbody>
    </table>

    <h2>Test Scenarios</h2>

    <!-- Test 1: Default Page Size -->
    <div class="test-scenario">
        <h3>Test 1: Default Page Size is 10 <span class="status status-pass">PASS</span></h3>
        <p><strong>Objective:</strong> Verify the default page size is 10 users per page</p>
        <div class="steps">
            <strong>Steps:</strong>
            <ol>
                <li>Navigate to Admin &gt; Manage &gt; Users</li>
                <li>Open the page size dropdown to see available options</li>
                <li>Verify the default selected option is "10 users per page"</li>
                <li>Count the number of users displayed in the list</li>
            </ol>
        </div>
        <p><strong>Expected Result:</strong> Default page size should be 10, and 10 users should be displayed</p>
        <p><strong>Actual Result:</strong> Default page size is "10 users per page" and exactly 10 users are displayed</p>
        <img src="User_List_Pagination_step01_default_pagesize_dropdown.png" alt="Default page size dropdown showing 10" class="screenshot">
        <img src="User_List_Pagination_step02_default_10_users.png" alt="10 users displayed" class="screenshot">
    </div>

    <!-- Test 2: Navigate to Next Page -->
    <div class="test-scenario">
        <h3>Test 2: Navigate to Next Page <span class="status status-pass">PASS</span></h3>
        <p><strong>Objective:</strong> Verify clicking the next page button navigates to the next page</p>
        <div class="steps">
            <strong>Steps:</strong>
            <ol>
                <li>Start on page 1 showing "Showing 1-10 of 16 entries"</li>
                <li>Click the next page button (right arrow)</li>
                <li>Verify page indicator updates to page 2</li>
                <li>Verify entry count updates to show remaining entries</li>
            </ol>
        </div>
        <p><strong>Expected Result:</strong> Page should advance to page 2 showing entries 11-16</p>
        <p><strong>Actual Result:</strong> Page successfully navigated to page 2, showing "Showing 11-16 of 16 entries"</p>
        <img src="User_List_Pagination_step04_next_page.png" alt="Next page navigation result" class="screenshot">
    </div>

    <!-- Test 3: Navigate to Previous Page -->
    <div class="test-scenario">
        <h3>Test 3: Navigate to Previous Page <span class="status status-pass">PASS</span></h3>
        <p><strong>Objective:</strong> Verify clicking the previous page button navigates back</p>
        <div class="steps">
            <strong>Steps:</strong>
            <ol>
                <li>Start on page 2 showing "Showing 11-16 of 16 entries"</li>
                <li>Click the previous page button (left arrow)</li>
                <li>Verify page indicator updates to page 1</li>
                <li>Verify entry count shows first 10 entries</li>
            </ol>
        </div>
        <p><strong>Expected Result:</strong> Page should go back to page 1 showing entries 1-10</p>
        <p><strong>Actual Result:</strong> Page successfully navigated back to page 1, showing "Showing 1-10 of 16 entries"</p>
        <img src="User_List_Pagination_step05_previous_page.png" alt="Previous page navigation result" class="screenshot">
    </div>

    <!-- Test 4: First/Last Page Boundaries -->
    <div class="test-scenario">
        <h3>Test 4: First/Last Page Boundaries <span class="status status-pass">PASS</span></h3>
        <p><strong>Objective:</strong> Verify first and last page navigation buttons work correctly</p>
        <div class="steps">
            <strong>Steps:</strong>
            <ol>
                <li>From page 1, click the "Last Page" button (double right arrow)</li>
                <li>Verify navigation to the last page</li>
                <li>Click the "First Page" button (double left arrow)</li>
                <li>Verify navigation back to page 1</li>
            </ol>
        </div>
        <p><strong>Expected Result:</strong> Should be able to jump directly to first and last pages</p>
        <p><strong>Actual Result:</strong> Last page button navigated to page 2 (showing 11-16), First page button returned to page 1 (showing 1-10)</p>
        <img src="User_List_Pagination_step06_last_page.png" alt="Last page navigation" class="screenshot">
        <img src="User_List_Pagination_step07_first_page.png" alt="First page navigation" class="screenshot">
    </div>

    <!-- Test 5: Change Page Size -->
    <div class="test-scenario">
        <h3>Test 5: Change Page Size (10, 25) <span class="status status-pass">PASS</span></h3>
        <p><strong>Objective:</strong> Verify page size can be changed and affects the display</p>
        <div class="steps">
            <strong>Steps:</strong>
            <ol>
                <li>Open the page size dropdown</li>
                <li>Select "25 users per page"</li>
                <li>Verify the list updates to show up to 25 users</li>
                <li>Verify pagination summary updates accordingly</li>
            </ol>
        </div>
        <p><strong>Expected Result:</strong> Page size should change to 25 and all 16 users should display on one page</p>
        <p><strong>Actual Result:</strong> Page size changed to 25, showing "Showing 1-16 of 16 entries" (all users on one page)</p>
        <img src="User_List_Pagination_step08_pagesize_25.png" alt="Page size changed to 25" class="screenshot">
    </div>

    <!-- Test 6: Total Users Count Display -->
    <div class="test-scenario">
        <h3>Test 6: Verify Total Users Count Display <span class="status status-pass">PASS</span></h3>
        <p><strong>Objective:</strong> Verify the total user count is displayed correctly in pagination</p>
        <div class="steps">
            <strong>Steps:</strong>
            <ol>
                <li>Navigate to Users page</li>
                <li>Observe the pagination summary text</li>
                <li>Verify format shows "Showing X-Y of Z entries"</li>
            </ol>
        </div>
        <p><strong>Expected Result:</strong> Should display total count in format "Showing X-Y of Z entries"</p>
        <p><strong>Actual Result:</strong> Total count correctly displayed as "16 entries" throughout testing</p>
        <img src="User_List_Pagination_step03_pagination_controls.png" alt="Pagination controls showing total count" class="screenshot">
    </div>

    <!-- Test 7: Current Page Indicator -->
    <div class="test-scenario">
        <h3>Test 7: Verify Current Page Indicator <span class="status status-pass">PASS</span></h3>
        <p><strong>Objective:</strong> Verify the current page number is clearly indicated</p>
        <div class="steps">
            <strong>Steps:</strong>
            <ol>
                <li>Navigate through different pages</li>
                <li>Observe the page indicator in the pagination controls</li>
                <li>Verify current page is highlighted/visible</li>
            </ol>
        </div>
        <p><strong>Expected Result:</strong> Current page number should be clearly visible in pagination controls</p>
        <p><strong>Actual Result:</strong> Current page number is displayed and highlighted (e.g., "1" or "2" shown between navigation arrows)</p>
        <img src="User_List_Pagination_step03_pagination_controls.png" alt="Page indicator showing current page" class="screenshot">
    </div>

    <!-- Test 8: Pagination Resets on Filter Change -->
    <div class="test-scenario">
        <h3>Test 8: Pagination Resets on Filter Change <span class="status status-fail">FAIL</span></h3>
        <p><strong>Objective:</strong> Verify pagination resets to page 1 when a filter is changed</p>
        <div class="steps">
            <strong>Steps:</strong>
            <ol>
                <li>Navigate to page 2 (showing entries 11-16)</li>
                <li>Change the filter from "Authorized" to "All"</li>
                <li>Verify pagination resets to page 1</li>
                <li>Verify entry count shows "Showing 1-10 of X entries"</li>
            </ol>
        </div>
        <p><strong>Expected Result:</strong> After filter change, pagination should reset to page 1 with "Showing 1-10 of X entries"</p>
        <p><strong>Actual Result:</strong> Filter changed successfully, but pagination indicator did NOT reset. Shows "Showing 11-16 of 16 entries" with page "2" highlighted, even though the data appears to be page 1 content (starting with Claude TestUser).</p>
        <div class="issue">
            <strong>Bug Found:</strong> Pagination indicator does not synchronize with the data when filter changes. The code sets <code>pageIndex = 0</code> and <code>resetIndex = true</code> on filter change, but the Pager component's visual indicator does not update to reflect the reset. This creates a mismatch between displayed data (page 1) and pagination indicator (page 2).
            <br><br>
            <strong>Location:</strong> src/Modules/Evoq.PersonaBar.Users/EvoqUsers.Web/src/components/Body/index.jsx (onFilterChange method)
            <br><br>
            <strong>Potential Cause:</strong> The <code>resetIndex</code> prop is set to <code>true</code> and then immediately set back to <code>false</code> in the setState callback, which may not give the Pager component enough time to react to the reset signal.
        </div>
        <p><strong>Before Filter Change (Page 2):</strong></p>
        <img src="User_List_Pagination_step09_on_page2_before_filter.png" alt="On page 2 before filter change" class="screenshot">
        <p><strong>After Filter Change (Bug - Still Shows Page 2):</strong></p>
        <img src="User_List_Pagination_step10_filter_changed_page_check.png" alt="After filter change - pagination not reset" class="screenshot">
    </div>

    <div class="observations">
        <h2>Observations</h2>
        <ul>
            <li><strong>Page Size Options Limited:</strong> The UI only offers page sizes of 10 and 25. The test scenarios suggested testing 50 and 100, but these options are not available in the current implementation.</li>
            <li><strong>Jump to Specific Page:</strong> The pagination does not provide numbered page buttons for direct navigation. Users can only use first/previous/next/last navigation. A "Jump to page" feature mentioned in test scenarios does not exist in the UI.</li>
            <li><strong>Empty User List:</strong> Could not test empty user list scenario without removing all users, which would affect other functionality.</li>
            <li><strong>Single Page of Users:</strong> With 16 users and default page size of 10, there are always 2 pages. Testing single-page scenario would require fewer users or larger page size (25 shows all on one page).</li>
            <li><strong>Code Verification:</strong> Reviewed the source code at <code>src/Modules/Evoq.PersonaBar.Users/EvoqUsers.Web/src/components/Body/index.jsx</code>:
                <ul>
                    <li>Default pageSize confirmed as 10 (line 30)</li>
                    <li>Uses <code>Pager</code> component from <code>@dnnsoftware/dnn-react-common</code></li>
                    <li>Filter change handler sets <code>pageIndex = 0</code> and <code>resetIndex = true</code> but the reset doesn't work correctly</li>
                </ul>
            </li>
        </ul>
    </div>

    <h2>Test Environment</h2>
    <ul>
        <li><strong>Website URL:</strong> http://localhost:8081</li>
        <li><strong>Browser:</strong> Chromium (via Playwright)</li>
        <li><strong>Viewport:</strong> 1280x720</li>
        <li><strong>User:</strong> SuperUser Account (host)</li>
        <li><strong>Total Users in System:</strong> 16</li>
    </ul>

    <h2>Conclusion</h2>
    <p>
        <strong>Overall Result: 7 PASS, 1 FAIL</strong>
    </p>
    <p>
        The User List Pagination feature is mostly functional with core navigation working correctly.
        However, a significant bug was found where the pagination indicator does not reset when filters are changed,
        creating a visual mismatch between the displayed data and the pagination controls.
        This should be addressed to ensure consistent user experience.
    </p>

</body>
</html>
