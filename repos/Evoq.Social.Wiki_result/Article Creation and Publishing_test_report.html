<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Report: Article Creation and Publishing - Evoq.Social.Wiki</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
            line-height: 1.6;
        }
        h1 {
            color: #333;
            border-bottom: 3px solid #0078d4;
            padding-bottom: 15px;
        }
        h2 {
            color: #0078d4;
            margin-top: 40px;
            border-left: 4px solid #0078d4;
            padding-left: 15px;
        }
        h3 {
            color: #444;
            margin-top: 30px;
        }
        .feature-info {
            background-color: #e7f3ff;
            border: 1px solid #b3d7ff;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        .feature-info p {
            margin: 8px 0;
        }
        .test-case {
            background-color: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-case h3 {
            margin-top: 0;
        }
        .status {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            color: white;
            margin-left: 15px;
        }
        .status.pass {
            background-color: #28a745;
        }
        .status.fail {
            background-color: #dc3545;
        }
        .steps {
            background-color: #f8f9fa;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
        }
        .steps ol {
            margin: 0;
            padding-left: 25px;
        }
        .steps li {
            margin: 8px 0;
        }
        .screenshot {
            margin: 20px 0;
            text-align: center;
        }
        .screenshot img {
            max-width: 100%;
            border: 1px solid #ddd;
            border-radius: 5px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .screenshot p {
            font-style: italic;
            color: #666;
            margin-top: 8px;
        }
        .observations {
            background-color: #fff3cd;
            border: 1px solid #ffc107;
            border-radius: 8px;
            padding: 20px;
            margin: 30px 0;
        }
        .summary {
            background-color: #d4edda;
            border: 1px solid #28a745;
            border-radius: 8px;
            padding: 20px;
            margin: 30px 0;
        }
        .summary h2 {
            color: #28a745;
            border-left-color: #28a745;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #0078d4;
            color: white;
        }
        tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        .tech-note {
            background-color: #e2e3e5;
            border-left: 4px solid #6c757d;
            padding: 10px 15px;
            margin: 10px 0;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <h1>Test Report: Article Creation and Publishing</h1>

    <div class="feature-info">
        <h2 style="margin-top: 0; border-left: none; padding-left: 0;">Feature Information</h2>
        <p><strong>Extension:</strong> Evoq.Social.Wiki (Module)</p>
        <p><strong>Feature Name:</strong> Article Creation and Publishing</p>
        <p><strong>Description:</strong> Create new wiki articles with title, content, and metadata, supporting both draft and published states</p>
        <p><strong>Feature Priority:</strong> Top</p>
        <p><strong>UI Location:</strong> Wiki Module > Add New Article button or Edit existing article</p>
        <p><strong>Test Date:</strong> January 6, 2026</p>
        <p><strong>Tester:</strong> Automated (Claude Code)</p>
    </div>

    <div class="summary">
        <h2>Test Summary</h2>
        <table>
            <tr>
                <th>Test Case</th>
                <th>Status</th>
            </tr>
            <tr>
                <td>1. Create new article as draft</td>
                <td><span class="status pass">PASS</span></td>
            </tr>
            <tr>
                <td>2. Create article and publish immediately</td>
                <td><span class="status pass">PASS</span></td>
            </tr>
            <tr>
                <td>3. Create primary/home article for module</td>
                <td><span class="status pass">PASS</span></td>
            </tr>
            <tr>
                <td>4. Validate required fields (title, content, tags)</td>
                <td><span class="status pass">PASS</span></td>
            </tr>
            <tr>
                <td>5. Duplicate article title prevention</td>
                <td><span class="status pass">PASS</span></td>
            </tr>
            <tr>
                <td>6. Special characters in title</td>
                <td><span class="status pass">PASS</span></td>
            </tr>
            <tr>
                <td>7. Edit existing article</td>
                <td><span class="status pass">PASS</span></td>
            </tr>
            <tr>
                <td>8. Delete article</td>
                <td><span class="status pass">PASS</span></td>
            </tr>
        </table>
        <p><strong>Total Tests:</strong> 8 | <strong>Passed:</strong> 8 | <strong>Failed:</strong> 0 | <strong>Pass Rate:</strong> 100%</p>
    </div>

    <h2>Detailed Test Results</h2>

    <!-- Test Case 1 -->
    <div class="test-case">
        <h3>Test 1: Create New Article as Draft <span class="status pass">PASS</span></h3>
        <p><strong>Objective:</strong> Verify that users can create a new wiki article and save it as a draft.</p>

        <div class="steps">
            <strong>Steps Taken:</strong>
            <ol>
                <li>Navigated to Wiki module page at http://localhost:8081/wiki</li>
                <li>Clicked "Add an article" button</li>
                <li>Selected article type "Article" from dropdown</li>
                <li>Entered title: "Test Draft Article"</li>
                <li>Added content using Redactor editor</li>
                <li>Added tag: "testing"</li>
                <li>Clicked "Publish" button (without moderator approval status)</li>
            </ol>
        </div>

        <p><strong>Expected Result:</strong> Article should be created as a draft awaiting moderation.</p>
        <p><strong>Actual Result:</strong> Article was successfully created and displayed "awaiting moderation" status, confirming draft state.</p>

        <div class="screenshot">
            <img src="Article_Creation_and_Publishing_step01_wiki_page.png" alt="Wiki page with articles">
            <p>Wiki module page showing existing articles</p>
        </div>
        <div class="screenshot">
            <img src="Article_Creation_and_Publishing_step02_create_dialog.png" alt="Create article dialog">
            <p>Article creation dialog with form fields</p>
        </div>
        <div class="screenshot">
            <img src="Article_Creation_and_Publishing_step03_draft_form_filled.png" alt="Draft form filled">
            <p>Form filled with draft article details</p>
        </div>
        <div class="screenshot">
            <img src="Article_Creation_and_Publishing_step05_draft_created_success.png" alt="Draft created successfully">
            <p>Draft article created - showing "awaiting moderation" status</p>
        </div>
    </div>

    <!-- Test Case 2 -->
    <div class="test-case">
        <h3>Test 2: Create Article and Publish Immediately <span class="status pass">PASS</span></h3>
        <p><strong>Objective:</strong> Verify that users with moderator permissions can publish an article immediately.</p>

        <div class="steps">
            <strong>Steps Taken:</strong>
            <ol>
                <li>Clicked "Add an article" button</li>
                <li>Selected article type "Article"</li>
                <li>Entered title: "Published Test Article"</li>
                <li>Added content describing a published article</li>
                <li>Added tag: "published"</li>
                <li>Checked "Approved" checkbox (moderator action)</li>
                <li>Clicked "Publish" button</li>
            </ol>
        </div>

        <p><strong>Expected Result:</strong> Article should be published immediately without moderation queue.</p>
        <p><strong>Actual Result:</strong> Article was published successfully, displaying without "awaiting moderation" status.</p>

        <div class="screenshot">
            <img src="Article_Creation_and_Publishing_step06_publish_form_filled.png" alt="Publish form">
            <p>Form filled with "Approved" checkbox checked</p>
        </div>
        <div class="screenshot">
            <img src="Article_Creation_and_Publishing_step02_publish_success.png" alt="Article published">
            <p>Article published successfully - no moderation status shown</p>
        </div>

        <div class="tech-note">
            <strong>Technical Note:</strong> The system uses RevisionState.Published vs RevisionState.Pending to differentiate between published and draft articles. The "Approved" checkbox triggers the Publish endpoint instead of SaveDraft.
        </div>
    </div>

    <!-- Test Case 3 -->
    <div class="test-case">
        <h3>Test 3: Create Primary/Home Article for Module <span class="status pass">PASS</span></h3>
        <p><strong>Objective:</strong> Verify that users can create a primary (home) article for the wiki module.</p>

        <div class="steps">
            <strong>Steps Taken:</strong>
            <ol>
                <li>Clicked "Edit" button in the primary article area at top of wiki page</li>
                <li>Observed simplified dialog without title, type, or tags fields</li>
                <li>Added content for the home article</li>
                <li>Clicked "Publish" button</li>
            </ol>
        </div>

        <p><strong>Expected Result:</strong> Primary article should use simplified editor (content only) since it doesn't need title/tags.</p>
        <p><strong>Actual Result:</strong> Primary article dialog showed only content editor, confirming simplified interface for home articles.</p>

        <div class="screenshot">
            <img src="Article_Creation_and_Publishing_step03_primary_article_dialog.png" alt="Primary article dialog">
            <p>Simplified primary article editor - content only</p>
        </div>
        <div class="screenshot">
            <img src="Article_Creation_and_Publishing_step04_primary_article_created.png" alt="Primary article created">
            <p>Primary article content updated successfully</p>
        </div>

        <div class="tech-note">
            <strong>Technical Note:</strong> Primary articles have <code>primaryArticle: true</code> flag which bypasses title/type/tag validation in the JavaScript validators.
        </div>
    </div>

    <!-- Test Case 4 -->
    <div class="test-case">
        <h3>Test 4: Validate Required Fields <span class="status pass">PASS</span></h3>
        <p><strong>Objective:</strong> Verify that the system properly validates required fields before submission.</p>

        <div class="steps">
            <strong>Steps Taken:</strong>
            <ol>
                <li>Opened new article creation dialog</li>
                <li>Left all fields empty (no type, no title, no content, no tags)</li>
                <li>Clicked "Publish" button</li>
                <li>Observed validation errors</li>
            </ol>
        </div>

        <p><strong>Expected Result:</strong> System should show validation errors for all required fields.</p>
        <p><strong>Actual Result:</strong> Validation errors displayed for: Article Type ("This field is required"), Title ("This field is required"), Tags ("This field is required"), and Content ("Text is required").</p>

        <div class="screenshot">
            <img src="Article_Creation_and_Publishing_step05_required_fields_validation.png" alt="Validation errors">
            <p>Validation errors shown for all required fields</p>
        </div>

        <div class="tech-note">
            <strong>Technical Note:</strong> Client-side validation is implemented in dnn.wiki.ContentEditor.js using customValidators array. Server-side validation also exists in ContentController.cs for EmptyArticleTitle.
        </div>
    </div>

    <!-- Test Case 5 -->
    <div class="test-case">
        <h3>Test 5: Duplicate Article Title Prevention <span class="status pass">PASS</span></h3>
        <p><strong>Objective:</strong> Verify that the system prevents creating articles with duplicate titles.</p>

        <div class="steps">
            <strong>Steps Taken:</strong>
            <ol>
                <li>Opened new article creation dialog</li>
                <li>Selected article type "Article"</li>
                <li>Entered title matching existing article: "Published Test Article"</li>
                <li>Added content and tags</li>
                <li>Checked "Approved" and clicked "Publish"</li>
                <li>Observed error response</li>
            </ol>
        </div>

        <p><strong>Expected Result:</strong> System should reject the duplicate title and display an error.</p>
        <p><strong>Actual Result:</strong> Server returned HTTP 406 (Not Acceptable) with error message indicating the article already exists. Article was not created.</p>

        <div class="screenshot">
            <img src="Article_Creation_and_Publishing_step06_duplicate_title_error.png" alt="Duplicate title error">
            <p>Error dialog showing duplicate title rejection (HTTP 406)</p>
        </div>

        <div class="tech-note">
            <strong>Technical Note:</strong> Duplicate detection uses <code>ArticleController.GetArticleBySubject()</code> method. The server throws <code>ArticleAlreadyExists</code> exception which returns HTTP 406.
        </div>
    </div>

    <!-- Test Case 6 -->
    <div class="test-case">
        <h3>Test 6: Special Characters in Title <span class="status pass">PASS</span></h3>
        <p><strong>Objective:</strong> Verify that articles can be created with special characters in the title.</p>

        <div class="steps">
            <strong>Steps Taken:</strong>
            <ol>
                <li>Opened new article creation dialog</li>
                <li>Selected article type "Article"</li>
                <li>Entered title with special characters: "Special Chars Test: @#$%&*()!"</li>
                <li>Added content and tag "special-chars"</li>
                <li>Checked "Approved" and clicked "Publish"</li>
            </ol>
        </div>

        <p><strong>Expected Result:</strong> Article should be created successfully with special characters preserved in title.</p>
        <p><strong>Actual Result:</strong> Article was created and published successfully. Title displayed correctly with all special characters preserved.</p>

        <div class="screenshot">
            <img src="Article_Creation_and_Publishing_step07_special_chars_title.png" alt="Special characters in title">
            <p>Article created with special characters in title: @#$%&*()!</p>
        </div>
    </div>

    <!-- Test Case 7 -->
    <div class="test-case">
        <h3>Test 7: Edit Existing Article <span class="status pass">PASS</span></h3>
        <p><strong>Objective:</strong> Verify that existing articles can be edited and updated.</p>

        <div class="steps">
            <strong>Steps Taken:</strong>
            <ol>
                <li>Navigated to existing article "Special Chars Test: @#$%&*()!"</li>
                <li>Clicked "Edit" button</li>
                <li>Observed pre-filled form with existing data</li>
                <li>Modified content to add "EDITED" text</li>
                <li>Clicked "Publish" to save changes</li>
            </ol>
        </div>

        <p><strong>Expected Result:</strong> Article should be updated with new content while preserving other fields.</p>
        <p><strong>Actual Result:</strong> Article was updated successfully. Content now shows the edited text while title and other metadata remained intact.</p>

        <div class="screenshot">
            <img src="Article_Creation_and_Publishing_step08_edit_dialog.png" alt="Edit dialog">
            <p>Edit dialog showing pre-filled article data</p>
        </div>
        <div class="screenshot">
            <img src="Article_Creation_and_Publishing_step09_edited_article.png" alt="Edited article">
            <p>Article updated with new content - "EDITED" visible</p>
        </div>

        <div class="tech-note">
            <strong>Technical Note:</strong> Edit uses the same ContentEditor control. The <code>ArticleController.Update()</code> method handles updates while <code>RevisionController</code> manages version history.
        </div>
    </div>

    <!-- Test Case 8 -->
    <div class="test-case">
        <h3>Test 8: Delete Article <span class="status pass">PASS</span></h3>
        <p><strong>Objective:</strong> Verify that articles can be deleted by authorized users.</p>

        <div class="steps">
            <strong>Steps Taken:</strong>
            <ol>
                <li>Navigated to article "Special Chars Test: @#$%&*()!"</li>
                <li>Clicked "Delete" button</li>
                <li>Confirmed deletion in confirmation dialog</li>
                <li>Observed article removal</li>
                <li>Verified article count decreased</li>
            </ol>
        </div>

        <p><strong>Expected Result:</strong> Article should be permanently deleted from the wiki.</p>
        <p><strong>Actual Result:</strong> Article was successfully deleted. Redirected to wiki homepage. Article count decreased (confirming removal).</p>

        <div class="screenshot">
            <img src="Article_Creation_and_Publishing_step10_delete_confirmation.png" alt="Delete confirmation">
            <p>Delete confirmation dialog</p>
        </div>
        <div class="screenshot">
            <img src="Article_Creation_and_Publishing_step11_after_delete.png" alt="After delete">
            <p>Wiki page after deletion - article removed</p>
        </div>

        <div class="tech-note">
            <strong>Technical Note:</strong> Delete operation in <code>ArticleController.Delete()</code> removes: notifications, revisions, journal entries, comments, subscriptions, and finally the article record itself.
        </div>
    </div>

    <div class="observations">
        <h2 style="margin-top: 0; color: #856404; border-left-color: #856404;">Observations</h2>
        <ul>
            <li><strong>Profanity Filter:</strong> Code suggests profanity filtering exists via integration with DNN's content workflow, but specific filter testing would require known profanity terms. The feature appears to be part of the broader content moderation system.</li>
            <li><strong>Maximum Title Length:</strong> Code does not show explicit maximum length validation for titles. The database schema would define this limit. Testing showed titles with ~35 characters worked fine.</li>
            <li><strong>Redactor Editor Integration:</strong> Content must be set through Redactor's API (<code>$('#content').dnnRedactor('code.set', content)</code>) rather than direct DOM manipulation for validation to work properly.</li>
            <li><strong>Revision System:</strong> The wiki integrates with Evoq.Revisions for version control. Each save creates a revision entry, enabling history tracking and rollback capabilities.</li>
            <li><strong>Group Integration:</strong> Articles can be associated with social groups via groupId parameter, enabling group-specific wiki content.</li>
            <li><strong>Table of Contents:</strong> A TOC toggle option exists in the editor (<code>this.toc = window.ko.observable(true)</code>) but was not explicitly tested as it's a secondary feature.</li>
        </ul>
    </div>

    <footer style="margin-top: 40px; padding-top: 20px; border-top: 1px solid #ddd; color: #666; font-size: 0.9em;">
        <p>Generated by Claude Code automated testing | Test Environment: http://localhost:8081 | DNN Platform with Evoq.Social.Wiki module</p>
    </footer>
</body>
</html>
