<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Table of Contents - Test Report</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        h1 {
            color: #333;
            border-bottom: 3px solid #0078d4;
            padding-bottom: 10px;
        }
        h2 {
            color: #0078d4;
            margin-top: 30px;
        }
        h3 {
            color: #444;
        }
        .feature-info {
            background-color: #e7f3ff;
            border-left: 4px solid #0078d4;
            padding: 15px;
            margin: 20px 0;
        }
        .test-scenario {
            background-color: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .pass {
            background-color: #d4edda;
            color: #155724;
            padding: 5px 15px;
            border-radius: 4px;
            font-weight: bold;
            display: inline-block;
        }
        .fail {
            background-color: #f8d7da;
            color: #721c24;
            padding: 5px 15px;
            border-radius: 4px;
            font-weight: bold;
            display: inline-block;
        }
        .steps {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .steps ol {
            margin: 0;
            padding-left: 20px;
        }
        .screenshot {
            max-width: 100%;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin: 10px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .observations {
            background-color: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 20px 0;
        }
        .summary {
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: left;
        }
        th {
            background-color: #0078d4;
            color: white;
        }
        tr:nth-child(even) {
            background-color: #f8f9fa;
        }
    </style>
</head>
<body>
    <h1>Table of Contents - Test Report</h1>

    <div class="feature-info">
        <h3>Feature Information</h3>
        <table>
            <tr><th>Feature Name</th><td>Table of Contents</td></tr>
            <tr><th>Extension</th><td>Evoq.Social.Wiki (Module)</td></tr>
            <tr><th>Priority</th><td>Low (Smoke Testing)</td></tr>
            <tr><th>Description</th><td>Automatically generate and display table of contents for articles</td></tr>
            <tr><th>UI Location</th><td>Wiki Module > Article View > Table of Contents section (if enabled)</td></tr>
            <tr><th>Test Date</th><td>January 6, 2026</td></tr>
        </table>
    </div>

    <h2>Test Summary</h2>
    <div class="summary">
        <table>
            <tr>
                <th>Test Scenario</th>
                <th>Status</th>
            </tr>
            <tr>
                <td>Enable TOC for article (TOC checkbox visible)</td>
                <td><span class="pass">PASS</span></td>
            </tr>
            <tr>
                <td>Generate TOC from headings</td>
                <td><span class="pass">PASS</span></td>
            </tr>
            <tr>
                <td>Test nested headings in TOC</td>
                <td><span class="pass">PASS</span></td>
            </tr>
            <tr>
                <td>Test TOC with no headings</td>
                <td><span class="pass">PASS</span></td>
            </tr>
        </table>
        <p><strong>Overall Result: 4/4 Tests Passed</strong></p>
    </div>

    <h2>Test Scenarios</h2>

    <!-- Test 1: Enable TOC for article -->
    <div class="test-scenario">
        <h3>Test 1: Enable TOC for article (TOC checkbox visible)</h3>
        <p><strong>Status:</strong> <span class="pass">PASS</span></p>

        <h4>What was tested:</h4>
        <p>Verified that the "Display a Table of Contents" checkbox is present and enabled by default when creating a new Wiki article.</p>

        <div class="steps">
            <h4>Steps taken:</h4>
            <ol>
                <li>Navigated to Wiki module at Community > Wiki</li>
                <li>Clicked "Create article" button</li>
                <li>Verified the "Display a Table of Contents" checkbox is present and checked by default</li>
            </ol>
        </div>

        <h4>Screenshots:</h4>
        <p><strong>Wiki List Page:</strong></p>
        <img src="Table_of_Contents_step01_wiki_list.png" alt="Wiki List Page" class="screenshot">

        <p><strong>Create Article Dialog with TOC Checkbox:</strong></p>
        <img src="Table_of_Contents_step03_create_dialog_toc_checkbox.png" alt="Create Article Dialog" class="screenshot">

        <h4>Result:</h4>
        <p>The "Display a Table of Contents" checkbox is visible in the Create Article dialog and is checked by default, allowing users to enable/disable TOC for each article.</p>
    </div>

    <!-- Test 2: Generate TOC from headings -->
    <div class="test-scenario">
        <h3>Test 2: Generate TOC from headings</h3>
        <p><strong>Status:</strong> <span class="pass">PASS</span></p>

        <h4>What was tested:</h4>
        <p>Created an article with h2, h3, and h4 headings and verified that the Table of Contents is automatically generated from these headings.</p>

        <div class="steps">
            <h4>Steps taken:</h4>
            <ol>
                <li>Created a new article titled "TOC Test Article - Jan 2026"</li>
                <li>Added HTML content with headings:
                    <ul>
                        <li>&lt;h2&gt;Introduction&lt;/h2&gt;</li>
                        <li>&lt;h2&gt;Main Section&lt;/h2&gt;</li>
                        <li>&lt;h3&gt;Subsection One&lt;/h3&gt;</li>
                        <li>&lt;h3&gt;Subsection Two&lt;/h3&gt;</li>
                        <li>&lt;h4&gt;Nested Subsection&lt;/h4&gt;</li>
                        <li>&lt;h2&gt;Conclusion&lt;/h2&gt;</li>
                    </ul>
                </li>
                <li>Ensured "Display a Table of Contents" checkbox was checked</li>
                <li>Published the article</li>
                <li>Verified TOC appeared in the sidebar</li>
            </ol>
        </div>

        <h4>Screenshots:</h4>
        <p><strong>Article Content with Headings:</strong></p>
        <img src="Table_of_Contents_step04_article_with_headings.png" alt="Article with Headings" class="screenshot">

        <p><strong>Generated Table of Contents:</strong></p>
        <img src="Table_of_Contents_step05_toc_generated.png" alt="Generated TOC" class="screenshot">

        <h4>Result:</h4>
        <p>The Table of Contents was successfully generated and displayed in the sidebar. The TOC correctly shows all h2, h3, and h4 headings from the article content.</p>
    </div>

    <!-- Test 3: Test nested headings in TOC -->
    <div class="test-scenario">
        <h3>Test 3: Test nested headings in TOC</h3>
        <p><strong>Status:</strong> <span class="pass">PASS</span></p>

        <h4>What was tested:</h4>
        <p>Verified that the TOC displays headings in a proper hierarchical/nested structure based on heading levels.</p>

        <div class="steps">
            <h4>Steps taken:</h4>
            <ol>
                <li>Used the article created in Test 2 with nested headings</li>
                <li>Verified the TOC displays correct hierarchy:
                    <ul>
                        <li>h2 headings as top-level items (numbered 1, 2, 3)</li>
                        <li>h3 headings nested under h2 (numbered i, ii)</li>
                        <li>h4 headings nested under h3 (numbered a)</li>
                    </ul>
                </li>
            </ol>
        </div>

        <h4>Expected TOC Structure:</h4>
        <pre style="background: #f8f9fa; padding: 15px; border-radius: 4px;">
Contents
  1. Introduction
  2. Main Section
     i. Subsection One
     ii. Subsection Two
         a. Nested Subsection
  3. Conclusion
        </pre>

        <h4>Screenshot:</h4>
        <img src="Table_of_Contents_step05_toc_generated.png" alt="Nested TOC Structure" class="screenshot">

        <h4>Result:</h4>
        <p>The TOC correctly displays the hierarchical structure with proper nesting and numbering. h2 headings are top-level items, h3 headings are nested below their parent h2, and h4 headings are further nested below h3.</p>
    </div>

    <!-- Test 4: Test TOC with no headings -->
    <div class="test-scenario">
        <h3>Test 4: Test TOC with no headings</h3>
        <p><strong>Status:</strong> <span class="pass">PASS</span></p>

        <h4>What was tested:</h4>
        <p>Verified that articles without h2/h3/h4 headings correctly display "No sections defined" in the Contents section.</p>

        <div class="steps">
            <h4>Steps taken:</h4>
            <ol>
                <li>Opened an existing article without headings ("Notification Test Article - Jan 2026")</li>
                <li>Verified the Contents section in the sidebar</li>
                <li>Confirmed it shows "No sections defined" message</li>
            </ol>
        </div>

        <h4>Screenshot:</h4>
        <img src="Table_of_Contents_step02_contents_section.png" alt="No Sections Defined" class="screenshot">

        <h4>Result:</h4>
        <p>The Contents section correctly displays "No sections defined" when the article content does not contain any h2, h3, or h4 headings. This is the expected behavior per the code review.</p>
    </div>

    <h2>Observations</h2>
    <div class="observations">
        <h3>Additional Findings</h3>
        <ul>
            <li><strong>TOC Enabled by Default:</strong> The "Display a Table of Contents" checkbox is checked by default when creating new articles, making it easy for users to use this feature.</li>
            <li><strong>Heading Detection:</strong> Based on code review (TableOfContentsController.cs), the TOC parses h2, h3, and h4 tags from article content. h1 is not included in TOC generation.</li>
            <li><strong>Real-time Generation:</strong> The TOC is generated dynamically when the article is viewed, based on the current content.</li>
            <li><strong>Code Pattern:</strong> The XPath used for heading detection is: <code>//*[self::h2 or self::h3 or self::h4]/text()</code></li>
        </ul>
    </div>

    <h2>Conclusion</h2>
    <p>The Table of Contents feature in Evoq.Social.Wiki is functioning correctly. All smoke tests passed:</p>
    <ul>
        <li>TOC can be enabled/disabled per article via checkbox</li>
        <li>TOC is automatically generated from h2, h3, h4 headings</li>
        <li>TOC displays proper hierarchical/nested structure</li>
        <li>Empty state ("No sections defined") displays correctly when no headings exist</li>
    </ul>

    <footer style="margin-top: 40px; padding-top: 20px; border-top: 1px solid #ddd; color: #666; font-size: 12px;">
        <p>Test Report Generated: January 6, 2026</p>
        <p>Extension: Evoq.Social.Wiki | Feature: Table of Contents | Priority: Low (Smoke Test)</p>
    </footer>
</body>
</html>
