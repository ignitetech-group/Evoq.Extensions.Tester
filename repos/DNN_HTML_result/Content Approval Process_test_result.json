{
  "metadata": {
    "extension_name": "DNN_HTML",
    "extension_type": "Module",
    "feature_name": "Content Approval Process",
    "feature_description": "Submit, review, approve or reject content through workflow states",
    "feature_priority": "High",
    "test_date": "2026-02-09T15:05:00Z",
    "tester": "Claude"
  },
  "test_scenarios": [
    {
      "scenario_name": "Workflow configuration availability",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Navigate to Settings > Workflow to view available workflows",
          "expected": "Should see workflow configuration options",
          "actual": "Found Workflow settings with three available workflows: Direct Publish (default), Save Draft, and Content Approval",
          "screenshot": "Content Approval Process_step02_workflow_config.png"
        },
        {
          "step_number": 2,
          "action": "View Content Approval workflow states",
          "expected": "Should see workflow states defined for Content Approval",
          "actual": "Content Approval workflow has 3 states: Draft -> Ready For Review -> Published",
          "screenshot": "Content Approval Process_step03_content_approval_workflow.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Set page workflow to Content Approval",
      "status": "FAIL",
      "steps": [
        {
          "step_number": 1,
          "action": "Navigate to Content > Pages and select Home page Details tab",
          "expected": "Should see workflow dropdown on page details",
          "actual": "Page details show Workflow dropdown with 'Direct Publish' selected. Page info shows 'Versioning: Off' and 'Workflow: Off'",
          "screenshot": "Content Approval Process_step11_page_details_direct_publish.png"
        },
        {
          "step_number": 2,
          "action": "Select 'Content Approval' from workflow dropdown",
          "expected": "Content Approval workflow should be selected",
          "actual": "Content Approval was selected successfully with 'Apply setting to all subpages' option appearing",
          "screenshot": "Content Approval Process_step12_content_approval_selected.png"
        },
        {
          "step_number": 3,
          "action": "Click Save button to apply workflow setting",
          "expected": "Workflow setting should persist after save",
          "actual": "Save succeeded with 'Page updated successfully' message, but workflow dropdown shows 'Content Approval'",
          "screenshot": "Content Approval Process_step13_workflow_saved_success.png"
        },
        {
          "step_number": 4,
          "action": "Re-select Home page to verify workflow persistence",
          "expected": "Workflow should still be set to 'Content Approval'",
          "actual": "Workflow reverted to 'Direct Publish'. Page info still shows 'Versioning: Off' and 'Workflow: Off'",
          "screenshot": "Content Approval Process_step15_workflow_reverted.png"
        }
      ],
      "issues": ["Workflow setting does not persist after saving. Despite successful save message, selecting Content Approval workflow reverts to Direct Publish when re-loading page details."]
    },
    {
      "scenario_name": "Edit content using inline editor",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Click 'Click to add text' in LeftPane to open inline editor",
          "expected": "Inline editor with formatting toolbar should appear",
          "actual": "Inline editor opened with toolbar containing Bold, Italic, Underline, Lists, Link, HTML view, Insert image, and Advanced Editor buttons",
          "screenshot": "Content Approval Process_step16_inline_editor_toolbar.png"
        },
        {
          "step_number": 2,
          "action": "Enter test content in the editor",
          "expected": "Content should be entered in the editor",
          "actual": "Successfully entered 'Test Content for Approval Workflow - This content needs to be reviewed and approved before publishing.'",
          "screenshot": "Content Approval Process_step17_content_entered.png"
        },
        {
          "step_number": 3,
          "action": "Click outside editor to close and save",
          "expected": "Content should be saved and displayed",
          "actual": "Content was saved and is displayed in the LeftPane module",
          "screenshot": "Content Approval Process_step18_content_saved_draft.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Discard changes confirmation dialog",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Click Discard button in edit bar",
          "expected": "Confirmation dialog should appear",
          "actual": "Dialog appeared with message 'Are you sure you want to discard the changes?' with Discard and Cancel buttons",
          "screenshot": "Content Approval Process_step19_discard_confirmation.png"
        },
        {
          "step_number": 2,
          "action": "Click Cancel to dismiss dialog",
          "expected": "Dialog should close and content should remain",
          "actual": "Dialog closed and content was preserved",
          "screenshot": "Content Approval Process_step18_content_saved_draft.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Publish content changes",
      "status": "FAIL",
      "steps": [
        {
          "step_number": 1,
          "action": "Click Publish button in edit bar",
          "expected": "Content should be published successfully",
          "actual": "Error dialog appeared: 'Another user has taken action on the page and its state has been changed. Please, refresh the page to see the current state.'",
          "screenshot": "Content Approval Process_step20_publish_error.png"
        },
        {
          "step_number": 2,
          "action": "Refresh page and retry Publish",
          "expected": "Publish should succeed after refresh",
          "actual": "Same error occurred again. Server returned 500 error for /API/EvoqContentLibrary/Publishing/PublishTab endpoint",
          "screenshot": "Content Approval Process_step22_publish_error_retry.png"
        }
      ],
      "issues": ["Publish functionality fails with 'page state changed' error. The API endpoint /API/EvoqContentLibrary/Publishing/PublishTab returns server error (500). This prevents content from being published through the workflow."]
    },
    {
      "scenario_name": "Discard content changes",
      "status": "FAIL",
      "steps": [
        {
          "step_number": 1,
          "action": "Click Discard button and confirm in dialog",
          "expected": "Draft changes should be discarded",
          "actual": "Error dialog appeared: 'Another user has taken action on the page and its state has been changed. Please, refresh the page to see the current state.'",
          "screenshot": "Content Approval Process_step24_discard_error.png"
        }
      ],
      "issues": ["Discard functionality fails with same 'page state changed' error. The API endpoint /API/EvoqContentLibrary/Publishing/DiscardTab returns server error (500). This prevents discarding draft content."]
    },
    {
      "scenario_name": "View pending approvals",
      "status": "FAIL",
      "steps": [
        {
          "step_number": 1,
          "action": "Attempt to access pending approvals through workflow",
          "expected": "Should be able to view content pending approval",
          "actual": "Could not test - Content Approval workflow could not be activated on page. Workflow setting does not persist.",
          "screenshot": "Content Approval Process_step15_workflow_reverted.png"
        }
      ],
      "issues": ["Cannot test pending approvals view because Content Approval workflow cannot be activated on pages."]
    },
    {
      "scenario_name": "Submit content for approval",
      "status": "FAIL",
      "steps": [
        {
          "step_number": 1,
          "action": "Attempt to submit content through approval workflow",
          "expected": "Should see submit for approval option in module actions",
          "actual": "Could not test - Content Approval workflow could not be activated. Only Direct Publish workflow is active showing Publish/Discard buttons.",
          "screenshot": "Content Approval Process_step21_after_refresh.png"
        }
      ],
      "issues": ["Cannot test submit for approval because Content Approval workflow does not persist on pages. The workflow dropdown shows Direct Publish regardless of saving Content Approval selection."]
    }
  ],
  "observations": [
    "Site-level versioning is enabled (Settings > Site Behavior > More shows Versioning: On with 10 maximum versions), but page-level versioning shows 'Off'.",
    "Content Approval workflow exists with proper state definitions (Draft -> Ready For Review -> Published) but cannot be activated on pages.",
    "Draft content indicator [DRAFT TEST] was visible on the page banner, suggesting some versioning mechanism is partially working.",
    "Both Publish and Discard API endpoints return 500 errors with 'page state changed' message, indicating a server-side state synchronization issue.",
    "The code in EditHtml.ascx.cs shows UserCanReview() method that checks WorkflowStatePermissionController.HasWorkflowStatePermission(), but this could not be tested due to workflow activation issues.",
    "The inline editor autosave functionality (5 second interval) from EditHtml.ascx works for saving content but may be contributing to state conflicts.",
    "Module Actions menu shows Admin and Move options but no Submit/Approve/Reject actions since Content Approval workflow is not active."
  ],
  "summary": {
    "total_scenarios": 8,
    "passed": 3,
    "failed": 5,
    "pass_rate": "38%"
  }
}
