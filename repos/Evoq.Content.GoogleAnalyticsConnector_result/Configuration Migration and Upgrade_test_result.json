{
  "metadata": {
    "extension_name": "Evoq.Content.GoogleAnalyticsConnector",
    "extension_type": "Connector",
    "feature_name": "Configuration Migration and Upgrade",
    "feature_description": "Handles migration of Google Analytics configuration during module upgrades",
    "feature_priority": "Medium",
    "test_date": "2026-02-09T14:43:00Z",
    "tester": "Claude"
  },
  "test_scenarios": [
    {
      "scenario_name": "GA4 Measurement ID Configuration",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Navigate to Connectors panel and click Connect on Google Analytics 4",
          "expected": "Google Analytics 4 connector settings panel opens with Measurement ID field",
          "actual": "Google Analytics 4 settings panel opened showing Measurement ID field and Track for Administrators checkbox",
          "screenshot": "Configuration_Migration_and_Upgrade_step01_ga4_connector_settings.png"
        },
        {
          "step_number": 2,
          "action": "Enter GA4 format measurement ID (G-TESTMIGRATE1) in the Measurement ID field",
          "expected": "GA4 format ID is accepted in the field",
          "actual": "G-TESTMIGRATE1 was entered successfully in the Measurement ID field",
          "screenshot": "Configuration_Migration_and_Upgrade_step02_ga4_id_entered.png"
        },
        {
          "step_number": 3,
          "action": "Click Save button to save the GA4 configuration",
          "expected": "Configuration saves successfully with success message",
          "actual": "Configuration saved successfully with 'Item successfully saved' message and green checkmark appeared",
          "screenshot": "Configuration_Migration_and_Upgrade_step03_ga4_saved_success.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Config File Migration Preserves Settings",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Close the connector panel after saving GA4 configuration",
          "expected": "Connector shows as connected with Edit button",
          "actual": "Google Analytics 4 connector shows green checkmark and Edit button instead of Connect",
          "screenshot": "Configuration_Migration_and_Upgrade_step04_ga4_connected_status.png"
        },
        {
          "step_number": 2,
          "action": "Click Edit to reopen the connector settings and verify persistence",
          "expected": "Previously saved GA4 Measurement ID (G-TESTMIGRATE1) is displayed",
          "actual": "G-TESTMIGRATE1 is displayed in the Measurement ID field, confirming persistence",
          "screenshot": "Configuration_Migration_and_Upgrade_step05_ga4_persistence_verified.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Backward Compatibility with Universal Analytics Format",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Change Measurement ID to Universal Analytics format (UA-123456789-1)",
          "expected": "UA format ID is accepted in the field",
          "actual": "UA-123456789-1 was entered successfully in the Measurement ID field",
          "screenshot": "Configuration_Migration_and_Upgrade_step06_ua_format_entered.png"
        },
        {
          "step_number": 2,
          "action": "Save the UA format configuration",
          "expected": "Configuration saves successfully supporting backward compatibility",
          "actual": "UA format configuration saved successfully with 'Item successfully saved' message",
          "screenshot": "Configuration_Migration_and_Upgrade_step07_ua_saved_success.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Upgrade from Universal Analytics to GA4",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Change Measurement ID from UA format back to GA4 format (G-MIGRATE2GA4)",
          "expected": "System accepts the migration from UA to GA4 format",
          "actual": "G-MIGRATE2GA4 was entered successfully, ready for save",
          "screenshot": "Configuration_Migration_and_Upgrade_step08_migrate_ua_to_ga4.png"
        },
        {
          "step_number": 2,
          "action": "Save the migrated GA4 configuration",
          "expected": "Migration from UA to GA4 saves successfully",
          "actual": "GA4 configuration saved successfully with 'Item successfully saved' message, migration completed",
          "screenshot": "Configuration_Migration_and_Upgrade_step09_ua_to_ga4_migration_success.png"
        }
      ],
      "issues": []
    }
  ],
  "observations": [
    "The automatic module upgrade migration via BusinessController.UpgradeModule() happens during package installation and is not UI-testable. Code review confirmed version 09.02.00 triggers UpgradeSiteAnalytics.UpdateSiteAnalyticsConfig() which backs up and updates SiteAnalytics.config.",
    "The EnsureConfig() method in GoogleAnalyticsConnector.cs automatically switches between SiteAnalytics.config (Universal Analytics) and SiteAnalytics.GA4.config templates based on tracking ID prefix (UA- vs G-).",
    "Code confirms the system supports three tracking ID formats: Universal (UA-), GA4 (G-), and Other. Each format triggers the appropriate script template to be used.",
    "The SiteAnalytics.config uses analytics.js for Universal Analytics while SiteAnalytics.GA4.config uses gtag.js for GA4.",
    "Custom script templates are supported through the [CUSTOM_SCRIPT] placeholder in both config files."
  ],
  "summary": {
    "total_scenarios": 4,
    "passed": 4,
    "failed": 0,
    "pass_rate": "100%"
  }
}
