<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Site Pages Search - Test Report</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
        }
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        h2 {
            color: #34495e;
            margin-top: 30px;
        }
        h3 {
            color: #7f8c8d;
        }
        .summary {
            background-color: #fff;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .test-case {
            background-color: #fff;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .pass {
            color: #27ae60;
            font-weight: bold;
        }
        .fail {
            color: #e74c3c;
            font-weight: bold;
        }
        .status-badge {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 14px;
        }
        .status-pass {
            background-color: #27ae60;
            color: white;
        }
        .status-fail {
            background-color: #e74c3c;
            color: white;
        }
        img {
            max-width: 100%;
            height: auto;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin: 10px 0;
        }
        .screenshot-container {
            margin: 15px 0;
        }
        .steps {
            background-color: #ecf0f1;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .steps ol {
            margin: 0;
            padding-left: 20px;
        }
        .info-table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
        }
        .info-table td, .info-table th {
            padding: 10px;
            border: 1px solid #ddd;
            text-align: left;
        }
        .info-table th {
            background-color: #3498db;
            color: white;
        }
        .info-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        .code-ref {
            font-family: 'Courier New', monospace;
            background-color: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.9em;
        }
        .observation {
            background-color: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 10px 15px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <h1>Site Pages Search - Test Report</h1>

    <div class="summary">
        <h2>Test Summary</h2>
        <table class="info-table">
            <tr>
                <th>Property</th>
                <th>Value</th>
            </tr>
            <tr>
                <td>Feature Name</td>
                <td>Site Pages Search</td>
            </tr>
            <tr>
                <td>Extension</td>
                <td>Evoq.PersonaBar.UrlManagement (PersonaBar Module)</td>
            </tr>
            <tr>
                <td>Description</td>
                <td>Search and retrieve site pages for URL management operations</td>
            </tr>
            <tr>
                <td>UI Location</td>
                <td>Admin > Persona Bar > Settings > SEO > URL Management > TEST URL > Page to Test</td>
            </tr>
            <tr>
                <td>Relevant Files</td>
                <td><span class="code-ref">UrlManagementServiceController.cs</span> - GetSitePages() method (lines 514-523), GetFilteredSitePages() method (lines 157-170)</td>
            </tr>
            <tr>
                <td>Test Date</td>
                <td>December 30, 2025</td>
            </tr>
            <tr>
                <td>Overall Status</td>
                <td><span class="status-badge status-pass">ALL TESTS PASSED</span></td>
            </tr>
        </table>
    </div>

    <div class="summary">
        <h2>Code Analysis</h2>
        <p>The Site Pages Search feature is implemented in <span class="code-ref">GetFilteredSitePages()</span> method:</p>
        <ul>
            <li><strong>API Endpoint:</strong> <span class="code-ref">GetSitePages(string searchText)</span> - HTTP GET method</li>
            <li><strong>Data Source:</strong> <span class="code-ref">TabController.GetPortalTabs()</span> - retrieves all portal pages</li>
            <li><strong>Filter Logic:</strong> Uses <span class="code-ref">IndexOf(searchText, StringComparison.InvariantCultureIgnoreCase)</span></li>
            <li><strong>Result Format:</strong> <span class="code-ref">KeyValuePair&lt;int, string&gt;</span> (TabID, LocalizedTabName)</li>
            <li><strong>Sorting:</strong> Results ordered alphabetically by page name</li>
        </ul>
    </div>

    <h2>Test Results</h2>

    <!-- Test Case 1 -->
    <div class="test-case">
        <h3>Test Case 1: Retrieve All Pages Without Search Filter</h3>
        <table class="info-table">
            <tr><th>Aspect</th><th>Details</th></tr>
            <tr><td>Status</td><td><span class="pass">PASS</span></td></tr>
            <tr><td>Description</td><td>Verify that all pages are returned when no search filter is applied</td></tr>
        </table>
        <div class="steps">
            <strong>Steps:</strong>
            <ol>
                <li>Navigate to SEO > URL Management > TEST URL tab</li>
                <li>Click on "Page to Test" dropdown</li>
                <li>Observe the page list without entering any search text</li>
            </ol>
        </div>
        <div class="screenshot-container">
            <p><strong>Screenshot:</strong></p>
            <img src="Site Pages Search_step02_all_pages_no_filter.png" alt="All pages without filter">
        </div>
        <p><strong>Result:</strong> 20 Results displayed including Home, Our Products, Activity Feed, News, Community, Search Results, 404 Error Page, Admin, Support, HubSpot Forms Test, etc.</p>
    </div>

    <!-- Test Case 2 -->
    <div class="test-case">
        <h3>Test Case 2: Search Pages by Title</h3>
        <table class="info-table">
            <tr><th>Aspect</th><th>Details</th></tr>
            <tr><td>Status</td><td><span class="pass">PASS</span></td></tr>
            <tr><td>Description</td><td>Verify that searching by exact page title returns correct results</td></tr>
        </table>
        <div class="steps">
            <strong>Steps:</strong>
            <ol>
                <li>Open the page picker dropdown</li>
                <li>Type "Home" in the search box</li>
                <li>Verify the filtered results</li>
            </ol>
        </div>
        <div class="screenshot-container">
            <p><strong>Screenshot:</strong></p>
            <img src="Site Pages Search_step03_search_by_title_home.png" alt="Search by title Home">
        </div>
        <p><strong>Result:</strong> 1 Result - "Home" page found and displayed correctly</p>
    </div>

    <!-- Test Case 3 -->
    <div class="test-case">
        <h3>Test Case 3: Search Pages by Partial Text Match</h3>
        <table class="info-table">
            <tr><th>Aspect</th><th>Details</th></tr>
            <tr><td>Status</td><td><span class="pass">PASS</span></td></tr>
            <tr><td>Description</td><td>Verify that partial text matching works correctly (contains search)</td></tr>
        </table>
        <div class="steps">
            <strong>Steps:</strong>
            <ol>
                <li>Open the page picker dropdown</li>
                <li>Type "Test" in the search box</li>
                <li>Verify pages containing "Test" in their name are returned</li>
            </ol>
        </div>
        <div class="screenshot-container">
            <p><strong>Screenshot:</strong></p>
            <img src="Site Pages Search_step04_partial_text_match.png" alt="Partial text match">
        </div>
        <p><strong>Result:</strong> 11 Results found including: HubSpot Forms Test, Marketo Forms Test, BulkTestPage1, BulkTestPage2, Workflow Test Page, Publish Test Page, URL Test Page, Test Normal Page, Test Page 1, Test Page 2, Test Page 3</p>
    </div>

    <!-- Test Case 4 -->
    <div class="test-case">
        <h3>Test Case 4: Case-Insensitive Search</h3>
        <table class="info-table">
            <tr><th>Aspect</th><th>Details</th></tr>
            <tr><td>Status</td><td><span class="pass">PASS</span></td></tr>
            <tr><td>Description</td><td>Verify that search is case-insensitive (lowercase search finds pages with mixed case)</td></tr>
        </table>
        <div class="steps">
            <strong>Steps:</strong>
            <ol>
                <li>Open the page picker dropdown</li>
                <li>Type "test" (lowercase) in the search box</li>
                <li>Compare results with "Test" (capital T) search</li>
            </ol>
        </div>
        <div class="screenshot-container">
            <p><strong>Screenshot:</strong></p>
            <img src="Site Pages Search_step05_case_insensitive.png" alt="Case insensitive search">
        </div>
        <p><strong>Result:</strong> 11 Results - Same results as "Test" search, confirming case-insensitive behavior. Implementation uses <span class="code-ref">StringComparison.InvariantCultureIgnoreCase</span></p>
    </div>

    <!-- Test Case 5 -->
    <div class="test-case">
        <h3>Test Case 5: Special Characters in Search</h3>
        <table class="info-table">
            <tr><th>Aspect</th><th>Details</th></tr>
            <tr><td>Status</td><td><span class="pass">PASS</span></td></tr>
            <tr><td>Description</td><td>Verify that pages with special characters in names can be found and are displayed safely (HTML-encoded)</td></tr>
        </table>
        <div class="steps">
            <strong>Steps:</strong>
            <ol>
                <li>Open the page picker dropdown</li>
                <li>Type "script" in the search box</li>
                <li>Verify the XSS test page is found and displayed safely</li>
            </ol>
        </div>
        <div class="screenshot-container">
            <p><strong>Screenshot:</strong></p>
            <img src="Site Pages Search_step06_special_characters.png" alt="Special characters search">
        </div>
        <p><strong>Result:</strong> 1 Result - Found page named <span class="code-ref">&lt;script&gt;alert('XSS')&lt;/script&gt;</span>. Special characters are properly HTML-encoded in the display, preventing XSS vulnerabilities.</p>
    </div>

    <!-- Test Case 6 -->
    <div class="test-case">
        <h3>Test Case 6: Empty Search Results Handling</h3>
        <table class="info-table">
            <tr><th>Aspect</th><th>Details</th></tr>
            <tr><td>Status</td><td><span class="pass">PASS</span></td></tr>
            <tr><td>Description</td><td>Verify that non-existent search terms are handled gracefully</td></tr>
        </table>
        <div class="steps">
            <strong>Steps:</strong>
            <ol>
                <li>Open the page picker dropdown</li>
                <li>Type "xyznonexistent123" in the search box</li>
                <li>Verify the UI handles zero results gracefully</li>
            </ol>
        </div>
        <div class="screenshot-container">
            <p><strong>Screenshot:</strong></p>
            <img src="Site Pages Search_step07_empty_results.png" alt="Empty results">
        </div>
        <p><strong>Result:</strong> 0 Results displayed. Only "&lt;None Specified&gt;" option remains. No errors or crashes - the UI handles empty results gracefully.</p>
    </div>

    <!-- Test Case 7 -->
    <div class="test-case">
        <h3>Test Case 7: Verify Page Properties in Results</h3>
        <table class="info-table">
            <tr><th>Aspect</th><th>Details</th></tr>
            <tr><td>Status</td><td><span class="pass">PASS</span></td></tr>
            <tr><td>Description</td><td>Verify that page properties (TabID, LocalizedTabName) are correctly returned and can be used for URL testing</td></tr>
        </table>
        <div class="steps">
            <strong>Steps:</strong>
            <ol>
                <li>Search for "Home" in the page picker</li>
                <li>Select the "Home" page from results</li>
                <li>Verify the page is selected and Test URL functionality becomes available</li>
            </ol>
        </div>
        <div class="screenshot-container">
            <p><strong>Screenshot:</strong></p>
            <img src="Site Pages Search_step08_page_selected.png" alt="Page selected">
        </div>
        <p><strong>Result:</strong> "Home" page successfully selected. The "Test URL" button becomes enabled, confirming that page properties (TabID internally, LocalizedTabName displayed) are correctly returned and usable.</p>
    </div>

    <div class="summary">
        <h2>Test Observations</h2>
        <div class="observation">
            <strong>Security Note:</strong> The search feature properly HTML-encodes special characters in page names, providing protection against XSS attacks.
        </div>
        <ul>
            <li>Search results are sorted alphabetically by page name</li>
            <li>The search uses a "contains" match (IndexOf), not just prefix matching</li>
            <li>Disabled pages (DisableLink == true) are excluded from results</li>
            <li>Results count is displayed at the bottom of the dropdown ("X Results")</li>
            <li>The "&lt;None Specified&gt;" option is always available as the first choice</li>
        </ul>
    </div>

    <div class="summary">
        <h2>Conclusion</h2>
        <p><strong>All 7 test scenarios passed successfully.</strong> The Site Pages Search feature works as expected:</p>
        <ul>
            <li>Retrieves all pages when no filter is applied</li>
            <li>Supports exact title search</li>
            <li>Supports partial text matching (contains search)</li>
            <li>Search is case-insensitive</li>
            <li>Handles special characters safely (HTML-encoded)</li>
            <li>Handles empty results gracefully</li>
            <li>Returns correct page properties (TabID, LocalizedTabName) for URL management operations</li>
        </ul>
    </div>

    <footer style="text-align: center; margin-top: 40px; padding: 20px; color: #7f8c8d;">
        <p>Test Report Generated: December 30, 2025</p>
        <p>Extension: Evoq.PersonaBar.UrlManagement | Feature: Site Pages Search</p>
    </footer>
</body>
</html>
