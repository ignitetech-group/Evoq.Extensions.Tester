{
  "metadata": {
    "extension_name": "Evoq.GoogleTagManagerConnector",
    "extension_type": "Connector",
    "feature_name": "GTM Container Configuration",
    "feature_description": "Configure Google Tag Manager container ID and settings for a portal including validation against Google servers",
    "feature_priority": "Top",
    "test_date": "2026-02-09T15:41:00Z",
    "tester": "Claude"
  },
  "test_scenarios": [
    {
      "scenario_name": "Save invalid container ID format",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Navigate to Admin > Settings > Connectors > Google Tag Manager",
          "expected": "GTM connector configuration panel should open",
          "actual": "GTM connector configuration panel opened with Container ID field and UseTagManagerForGA checkbox",
          "screenshot": "GTM Container Configuration_step02_gtm_config_panel.png"
        },
        {
          "step_number": 2,
          "action": "Enter invalid container ID format 'INVALID-123' and click Save",
          "expected": "Validation error should be displayed",
          "actual": "Error notification displayed: 'The Container Id is invalid or container hasn't been published yet.'",
          "screenshot": "GTM Container Configuration_step04_invalid_format_error.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Save non-existent container ID (valid GTM format)",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Enter non-existent GTM container ID 'GTM-XXXXXX' in valid format",
          "expected": "Value should be accepted in text field",
          "actual": "GTM-XXXXXX was entered in the Container ID field",
          "screenshot": "GTM Container Configuration_step05_nonexistent_gtm_entered.png"
        },
        {
          "step_number": 2,
          "action": "Click Save button",
          "expected": "Validation against Google servers should fail",
          "actual": "Error notification displayed: 'The Container Id is invalid or container hasn't been published yet.' - validation correctly rejected non-existent ID",
          "screenshot": "GTM Container Configuration_step06_nonexistent_gtm_error.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Save empty container ID to disable GTM",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Clear the Container ID field (leave empty)",
          "expected": "Field should accept empty value",
          "actual": "Container ID field was cleared successfully",
          "screenshot": "GTM Container Configuration_step07_empty_container_id.png"
        },
        {
          "step_number": 2,
          "action": "Click Save button",
          "expected": "Empty value should be accepted to disable GTM",
          "actual": "Success notification displayed: 'Item successfully saved.' - empty container ID accepted as per code design",
          "screenshot": "GTM Container Configuration_step08_empty_saved_success.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Save valid GTM container ID",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Enter valid GTM container ID 'GTM-5CVQBG'",
          "expected": "Value should be entered in text field",
          "actual": "GTM-5CVQBG was entered in the Container ID field",
          "screenshot": "GTM Container Configuration_step09_valid_gtm_entered.png"
        },
        {
          "step_number": 2,
          "action": "Click Save button",
          "expected": "Valid container ID should be saved successfully",
          "actual": "Success notification displayed: 'Item successfully saved.' Green checkmark appeared next to Google Tag Manager indicating configured status",
          "screenshot": "GTM Container Configuration_step10_valid_gtm_saved.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "UseTagManagerForGA checkbox functionality",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Toggle the 'This GTM container has already been configured to add the Google Analytics Script' checkbox from Off to On",
          "expected": "Checkbox should toggle to On state",
          "actual": "Checkbox toggled successfully to On state with blue switch indicator",
          "screenshot": "GTM Container Configuration_step11_checkbox_toggled_on.png"
        },
        {
          "step_number": 2,
          "action": "Click Save button",
          "expected": "Checkbox setting should be saved",
          "actual": "Success notification displayed: 'Item successfully saved.'",
          "screenshot": "GTM Container Configuration_step12_checkbox_saved.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Verify settings persist after save",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Click Cancel to close the configuration panel",
          "expected": "Panel should close and show connector status",
          "actual": "Panel closed. Google Tag Manager shows 'Edit' button (instead of 'Connect') and 'On' status, indicating configured state",
          "screenshot": "GTM Container Configuration_step13_panel_closed_configured.png"
        },
        {
          "step_number": 2,
          "action": "Click Edit button to reopen configuration panel",
          "expected": "Previously saved values should be displayed",
          "actual": "Container ID shows 'GTM-5CVQBG' and checkbox shows 'On' - settings persisted correctly",
          "screenshot": "GTM Container Configuration_step14_persistence_verified.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Edge case - XSS script injection attempt",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Enter XSS script '<script>alert('XSS')</script>' in Container ID field",
          "expected": "Input should be accepted in field but rejected on validation",
          "actual": "Script was entered in the field",
          "screenshot": "GTM Container Configuration_step15_special_chars_xss.png"
        },
        {
          "step_number": 2,
          "action": "Click Save button",
          "expected": "Validation should reject malicious input",
          "actual": "Error notification displayed: 'The Container Id is invalid or container hasn't been published yet.' - XSS attempt blocked by server-side validation",
          "screenshot": "GTM Container Configuration_step16_xss_rejected.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Edge case - Maximum length input",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Enter very long container ID string (100+ characters)",
          "expected": "Long string should be rejected",
          "actual": "Long string was entered in field",
          "screenshot": "GTM Container Configuration_step17_long_string_rejected.png"
        },
        {
          "step_number": 2,
          "action": "Click Save button",
          "expected": "Validation should reject excessively long input",
          "actual": "Error notification displayed: 'The Container Id is invalid or container hasn't been published yet.' - long string rejected by Google server validation",
          "screenshot": "GTM Container Configuration_step17_long_string_rejected.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Edge case - SQL injection attempt",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Enter SQL injection string \"'; DROP TABLE users; --\" in Container ID field",
          "expected": "Input should be accepted in field but rejected on validation",
          "actual": "SQL injection string was entered in the field",
          "screenshot": "GTM Container Configuration_step18_sql_injection_rejected.png"
        },
        {
          "step_number": 2,
          "action": "Click Save button",
          "expected": "Validation should reject malicious input",
          "actual": "Error notification displayed: 'The Container Id is invalid or container hasn't been published yet.' - SQL injection blocked by server-side validation",
          "screenshot": "GTM Container Configuration_step18_sql_injection_rejected.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Cancel button discards unsaved changes",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "After failed validation attempts, click Cancel button",
          "expected": "Unsaved changes should be discarded, original values restored",
          "actual": "Panel closed without saving invalid values",
          "screenshot": "GTM Container Configuration_step19_cancel_preserved_values.png"
        },
        {
          "step_number": 2,
          "action": "Click Edit to reopen and verify original values",
          "expected": "Original saved values should be displayed",
          "actual": "Container ID shows 'GTM-5CVQBG' and checkbox shows 'On' - original values correctly preserved after canceling invalid changes",
          "screenshot": "GTM Container Configuration_step19_cancel_preserved_values.png"
        }
      ],
      "issues": []
    }
  ],
  "observations": [
    "The GTM connector validates container IDs against Google's servers (https://www.googletagmanager.com/gtm.js?id={containerId}) rather than using format validation. This provides strong security as only valid, published containers can be configured.",
    "The code does NOT enforce GTM-XXXXXX format validation - any string is sent to Google for validation, which handles the actual verification.",
    "Empty container ID is intentionally allowed to disable GTM functionality - this sets UseTagManagerForGA to 'False' automatically.",
    "The UseTagManagerForGA checkbox is only meaningful when a valid container ID is configured.",
    "Security: XSS and SQL injection attempts are effectively blocked by the server-side Google validation - malicious strings will never be a valid GTM container ID.",
    "UI feedback is clear with success/error toast notifications appearing after save operations.",
    "Green checkmark indicator appears next to configured connectors in the list view.",
    "Button changes from 'Connect' to 'Edit' once a connector is configured."
  ],
  "summary": {
    "total_scenarios": 10,
    "passed": 10,
    "failed": 0,
    "pass_rate": "100%"
  }
}
