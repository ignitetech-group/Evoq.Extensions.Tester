{
  "metadata": {
    "extension_name": "Evoq.GoogleTagManagerConnector",
    "extension_type": "Connector",
    "feature_name": "Page Variant Tracking",
    "feature_description": "Tracks personalized page variants in GTM dataLayer for A/B testing and personalization analytics",
    "feature_priority": "Medium",
    "test_date": "2026-01-16T12:00:00Z",
    "tester": "Claude"
  },
  "test_scenarios": [
    {
      "scenario_name": "Verify default page variant 'Default' in dataLayer",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Login to DNN as SuperUser and navigate to Connectors panel",
          "expected": "Successfully logged in and Connectors panel accessible",
          "actual": "Successfully logged in as SuperUser Account. Connectors panel shows Google Tag Manager configured with Container ID GTM-5CVQBG",
          "screenshot": "Page_Variant_Tracking_step01_login_success.png"
        },
        {
          "step_number": 2,
          "action": "Verify GTM Connector configuration",
          "expected": "GTM Container ID is configured",
          "actual": "GTM is configured with Container ID: GTM-5CVQBG",
          "screenshot": "Page_Variant_Tracking_step02_gtm_config.png"
        },
        {
          "step_number": 3,
          "action": "Evaluate window.dataLayer on Home page using JavaScript",
          "expected": "dataLayer contains pageVariant property with value 'Default'",
          "actual": "dataLayer[0] contains {\"eaSendGaEvents\": false, \"pageVariant\": \"Default\"} - confirmed pageVariant is 'Default'",
          "screenshot": "Page_Variant_Tracking_step03_dataLayer_default.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Verify pageVariant appears in GTM dataLayer initialization",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Evaluate dataLayer structure to verify pageVariant position",
          "expected": "pageVariant should be in the first object of dataLayer array (initialization block)",
          "actual": "Confirmed pageVariant is in dataLayer[0] which is the GTM initialization block, alongside eaSendGaEvents. The GTM events (gtm.js, gtm.dom, gtm.load) come after in subsequent array positions.",
          "screenshot": "Page_Variant_Tracking_step03_dataLayer_default.png"
        }
      ],
      "issues": []
    },
    {
      "scenario_name": "Test variant tracking without personalization",
      "status": "PASS",
      "steps": [
        {
          "step_number": 1,
          "action": "Navigate to a different page (Our Products) and check dataLayer",
          "expected": "pageVariant should be 'Default' since no personalization is active",
          "actual": "Navigated to Our Products page. dataLayer evaluation shows pageVariant: 'Default' - consistent with expected behavior when no personalization is active",
          "screenshot": "Page_Variant_Tracking_step04_dataLayer_other_page.png"
        },
        {
          "step_number": 2,
          "action": "Verify consistency across pages",
          "expected": "pageVariant should be consistently present across all pages",
          "actual": "Confirmed pageVariant is present in dataLayer on both Home page and Our Products page with value 'Default'",
          "screenshot": "Page_Variant_Tracking_step04_dataLayer_other_page.png"
        }
      ],
      "issues": []
    }
  ],
  "observations": [
    "Code analysis confirms pageVariant is set in TagManagerModule.cs RenderCustomGtmScript() method (line 92-95)",
    "Default value 'Default' is used when HttpContext.Current.Items['evoq_PersonalizedPageVariantName'] is not set",
    "The constant 'evoq_PersonalizedPageVariantName' is defined in Constants.cs (line 20)",
    "Custom page variant names would require Content Personalization to be configured with active personalized page variants - this sets the HttpContext item that overrides the default",
    "Testing 'custom page variant name in dataLayer' and 'variant tracking with content personalization enabled' requires Content Personalization feature to be set up with active page variants - no UI element found to configure this in the scope of GTM Connector testing alone"
  ],
  "summary": {
    "total_scenarios": 3,
    "passed": 3,
    "failed": 0,
    "pass_rate": "100%"
  }
}
